<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA24168406" />

<meta name="date" content="2024-12-06" />

<title>Introduction to my homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to my homework</h1>
<h4 class="author">SA24168406</h4>
<h4 class="date">2024-12-06</h4>



<div id="example-1" class="section level2">
<h2>Example 1</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>已知一组人体身高和体重的样本数据，分析身高与体重之间的关系，创建一个人体身高与体重的预测模型。</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>基本思路：可以利用线性回归来对人体的身高和体重之间的关系进行建模。利用R语言线性回归函数lm()来创建关系模型，利用summary()函数获取关系模型的概要，最后使用predict()函数来预测人的体重。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># 样本数据</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">151</span>, <span class="dv">174</span>, <span class="dv">138</span>, <span class="dv">186</span>, <span class="dv">128</span>, <span class="dv">136</span>, <span class="dv">179</span>, <span class="dv">163</span>, <span class="dv">152</span>, <span class="dv">131</span>) <span class="co">#身高，单位cm</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">63</span>, <span class="dv">81</span>, <span class="dv">56</span>, <span class="dv">91</span>, <span class="dv">47</span>, <span class="dv">57</span>, <span class="dv">76</span>, <span class="dv">72</span>, <span class="dv">62</span>, <span class="dv">48</span>)           <span class="co">#体重，单位kg</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#调用lm()函数</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#调用summary()函数</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">summary</span>(ans)<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##                Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) -38.4550871 8.04901330 -4.777615 1.394928e-03
## x             0.6746104 0.05190514 12.996987 1.164405e-06</code></pre>
<p>The <span class="math inline">\(R^2\)</span> is 0.9547822<br />
从P值来看，自变量x对因变量y存在显著性影响关系；从模型拟合指标<span class="math inline">\(R^2\)</span>来看，很接近于1，说明模型中的自变量对因变量变异的解释很好。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">plot</span>(ans)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># 调用predict()判断身高为170cm的体重</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">170</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>result <span class="ot">&lt;-</span>  <span class="fu">predict</span>(ans,a)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##        1 
## 76.22869</code></pre>
<p>从诊断图Residuals vs
Leverage上来看，观测值4和7落在虚线之外，说明数据集中存在过度影响的点。<br />
从QQ图上来看，残差呈正态分布。<br />
从Scale-Location图来看，红线在绘图上并不完全水平，但它在任何点都不会偏离太远。所以不违反等方差的假设。<br />
从Residuals vs
Fitted图来看，红线偏离了完美的水平线，但并不明显。可以说残差遵循大致线性模式，并且线性回归模型适合该数据集。</p>
</div>
<div id="生成回归线" class="section level2">
<h2>生成回归线</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Height &amp; Weight Regression&quot;</span>,<span class="fu">abline</span>(ans),<span class="at">cex =</span> <span class="fl">1.3</span>,<span class="at">pch =</span> <span class="dv">16</span>,<span class="at">ylab =</span> <span class="st">&quot;Weight in Kg&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;Height in cm&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="线性回归方程公式" class="section level2">
<h2>线性回归方程公式</h2>
<p><span class="math display">\[Y=\beta_0+\beta_1X_1+\beta_2X_2+...+\beta_nX_n+\varepsilon\]</span>
其中，<span class="math inline">\(Y\)</span>是因变量，<span class="math inline">\(X_1\)</span>,<span class="math inline">\(X_2\)</span>,…,<span class="math inline">\(X_n\)</span>是自变量，<span class="math inline">\(\beta_0\)</span>,<span class="math inline">\(\beta_1\)</span>,<span class="math inline">\(\beta_2\)</span>,…,<span class="math inline">\(\beta_n\)</span>是回归系数，<span class="math inline">\(\varepsilon\)</span>是误差项。回归系数表示自变量对因变量的影响程度。</p>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>考虑如下的方差分析问题。某工厂要比较三种不同组装工艺(A,B,C)的工作效率，将15名工人随机分为3个组，每个组采用一种工艺，一周后各组的成品数如下：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">58</span>,<span class="dv">58</span>,<span class="dv">48</span>,<span class="dv">64</span>,<span class="dv">69</span>,<span class="dv">57</span>,<span class="dv">55</span>,<span class="dv">71</span>,<span class="dv">59</span>,<span class="dv">66</span>,<span class="dv">64</span>,<span class="dv">47</span>,<span class="dv">67</span>,<span class="dv">68</span>,<span class="dv">49</span>),<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">colnames</span>(tab) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(tab)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">58</td>
<td align="right">58</td>
<td align="right">48</td>
</tr>
<tr class="even">
<td align="right">64</td>
<td align="right">69</td>
<td align="right">57</td>
</tr>
<tr class="odd">
<td align="right">55</td>
<td align="right">71</td>
<td align="right">59</td>
</tr>
<tr class="even">
<td align="right">66</td>
<td align="right">64</td>
<td align="right">47</td>
</tr>
<tr class="odd">
<td align="right">67</td>
<td align="right">68</td>
<td align="right">49</td>
</tr>
</tbody>
</table>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>基本分析：该问题属于单因素方差分析例子，单因素方差分析可以看成基础统计中两样本t检验的一个推广，要比较试验观测值的某个因变量（称为“指标”）按照一个分组变量（称为“因素”）分组后，各组的因变量均值有无显著差异。<br />
设因素A将所有观测分为m个组，每组对因变量进行r次观测，且各次观测相互独立，模型为
<span class="math display">\[y_{ij}=\mu_i+e_{ij},i=1,2,...,m,j=1,2,...,r.\]</span>
<span class="math display">\[e_{ij} \sim N(0,\sigma^2)\]</span>
希望研究如下问题： <span class="math display">\[H_0:\mu_1=\mu_2=...=\mu_m.\]</span> 如果拒绝<span class="math inline">\(H_0\)</span>，希望找出哪些组的均值两两之间是有显著差异的。
先将上表转换成长表格式：</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tab)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>long_table <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(x, <span class="at">cols =</span> A<span class="sc">:</span>C, <span class="at">names_to =</span> <span class="st">&quot;grp&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>long_table <span class="ot">&lt;-</span> <span class="fu">arrange</span>(long_table,grp)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">print</span>(long_table)</span></code></pre></div>
<pre><code>## # A tibble: 15 × 2
##    grp   value
##    &lt;chr&gt; &lt;dbl&gt;
##  1 A        58
##  2 A        64
##  3 A        55
##  4 A        66
##  5 A        67
##  6 B        58
##  7 B        69
##  8 B        71
##  9 B        64
## 10 B        68
## 11 C        48
## 12 C        57
## 13 C        59
## 14 C        47
## 15 C        49</code></pre>
<p>用aov()函数进行方差分析：</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">aov</span>(value <span class="sc">~</span> grp, <span class="at">data=</span>long_table)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## grp          2    520  260.00   9.176 0.00382 **
## Residuals   12    340   28.33                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>主效应grp的F检验的p值为0.004， 若检验水平为0.05则分组效应显著，
各组之间有显著差异。<br />
可以用并列盒形图比较各组的取值，并检查分布对称性和方差齐性：</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> long_table, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> grp, <span class="at">y =</span> value)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6ObquOjo6OyP+QOgCQkDqQkGaQtpCQ2/+rbk2rbm6rbo6rjk2r5Mir5P+2ZgC225C2///Ijk3I///bkDrb/7bb///kq27k///r6+v/tmb/yI7/25D/5Kv//7b//8j//9v//+T////WfUbwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG7UlEQVR4nO2dCVfbRhRGzZYAaeKSFtKm0ATSFtfEDdRgg/X//1e1jLEbyfMx8tNi696TkJNzHrNczYzGssevF4GXXtMNaDsIEiBIgCABggQIEgQK+jeAoODWFYQgFYsgEYsgEYsgEYsgEYsgEYsgEYsgEYsgEYsgEbtBgg6sCkKQAEECBAkQJLAVdHuccB49fjh+e4egYu7f3s2uzqPbdwgq5PGX6+jx16/R5OevCCqcZfHImZzepaKi6CDGO96qoplaHT5BqZd4ljlBCVVdLy+tHUGJm6URhKDvuTlLhhFr0CpmX5JxM7s64y5WjJtY7INCqKo5XhAkQJAAQQkHJamqRe0TFNaQOQhCkANBAgQJECRAkABBAvZBAgQJmGICBAkQJNgSQdVRVpBtK/IwglbFIkjEIkjEVi8o7EkpglQ0gkQ0gkQ0gkQ0gkQ0gkQ0gkQ0gkT0dgqyew64rYLMuoUg0S0EiW4hSHQLQaJbGyhodnX85jo71PLDqo8Bd1rQzXn6UfL4nwUIWpB8gjyaf1p6DoIWTE7/TKbY44f01FhUfJjF7r2IzXtXY/L+PDmoMfnpemkUMYIWLJ9ieV6HELTg8SOCInUXi0dRciOb/cFtvoB4eU72P/E+6M3zjQxBAgQJECTIdYsHZrUJMiupXYLCfn1O4OPqoGhfp0NiESRiESRiESRiESRiESRiESRiESRiESRiESRiESRiESRiESRiywnK9bSOX2vtd5gVkLu45Wrd3hGUazuCEISg4lgEiVgEiVgEiVgEiVgEiVgEiVgEiVgEiVgEiVgEidhCQaNe72S09w1BKwQN9v7pnzxd7COoWNC0fxL/ica7QwQhSMYWCIpGyRSb9o+y/7nDLN5vJO+YoGjci3F+3GEWf2aWrglaxh1m8WdF6LIgd5jFn5mlW+9qTPu9lGyRdodZ/JlZujiCpj9epv+6oePPzNJFQdE420q7wyysQXlBbh+UHWbxZ2bppKCBezHmDrOwD3rGLdI7l6t7lmt7pwS9gFzbEYQgx3wT9LwP2kJBIQXlBL2MXJUIQtASD6+YYnOKBD1dHD1dpM/MELTqiWI0OJq/1EBQoaDR/hY/cl17DRqkdnzv++Sq7JageBGKBlv8UqOJ23wNZ5WbSZZoJMiqOf62WhW0/iJ9VOAEQQtG8S7RswlCUMzA/zwohEbfjCikTIuKnigG7IOsrpf/YloVZDSCPH66LkjPr6qa42+rVUEWLzUEVTXH31argtgHpdXa7F23WFBYj+YgCEHzahEkqkWQqBZBoloEiWoRJKpFkKgWQaJaBIlqESSqRZCoFkGi2toEuZQs3sws3pYG9ctDWwW5b/r3ZmbxtjSoXx5aKsgl0/BnZvG2NKhfHloqyKVk8WdmaSHG52s8p32ylCz+zCx2F96soHrvYt+vQ9X1y6wgBAlqE+RSsvgzs9j1y6ygWvdBLkPd6swsdv0yK2hzdtIIMu2XWUEIEiBIgCABggQIEiBIgCABggQIEiBIgCABggQIEiBI0KygDaC2dzUKqe7CmxXEFBMgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBLUflbD+4Xbdv0yK6jusxr+xCN2/TIrqO6zGv4v/bfrl1lBdZ/V8CceaSF1n9XwJx6xu/BmBdV9FMGfeMSuX2YF1S2INWgV7pCGP/GIXb/MCqr9rAb7oBCq65dZQQgSIEiwOd+ChyDTfpkVxBQTIEiAIAGCBAgSIEiAIAGCBGwUy9OybyRHkKoisPnVF4QgQQ2CNhujzCw+Qq5XJ0dQSHMQpKoIbH71BSHIsCAEqVgEiVgEiVgEiVgEiVgEiVgEiVgEiVgEiVgEidhygkIw+0hsowUhSIAgAYIEnXrkWgYECRAkQJAAQYLKBC0OwKzF5P3xPHXOmtzH5SyODLyYygTd/3ZmUUx6jiY5mbUut0kKsJtwQ1UJmn3562P45cqTCvp/hqpSZAM6OV8aSFWCJqd3NxYTIxtBp2u7vi8xu1KqEnR7Ft2/02GSbA0q27sFpRtTkaDZ1XLivzXIplj4zMiVU3YQViQobY/FHMsOO65fUtvWoNukIRZzLBVksWVo110sy7dl0a/t3QdtCwgSIEiAIAGCBAgSIEiAIAGCBO0VNO33dj4fDh8Of+/t/v36U6+3962JZrRW0LR/FP/dHT682o+ih1e7w6eL/Sba0VpB491hFI0SQSeJoOTH68sG2tFaQaNkRj3EUyzRkv6Y9k8aaAeCBK0VlE6x+EcmKJ1ih8MG2tFaQc+LdCaIRTpHcpv/NBeU3OYb8dNiQQljt/dp5gaW0lpB453L6HlWIaiAUW8xqxDUXhAkQJAAQQIECRAkQJDgP0+bluFcawuwAAAAAElFTkSuQmCC" /><!-- --><br />
从图形看，C组的工作效率显著低于A组和B组，A、B两组之间差异不明显。<br />
为了检查各组方差是否相等，可以进行Bartlett检验：</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">bartlett.test</span>(value <span class="sc">~</span> grp, <span class="at">data =</span> long_table)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  value by grp
## Bartlett&#39;s K-squared = 0.024476, df = 2, p-value = 0.9878</code></pre>
<p>结果表明可以认为各组的方差相等。</p>
</div>
<div id="example-3" class="section level2">
<h2>Example 3</h2>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>两因素方差分析计算示例：以R的datasets包的ToothGrowth数据为例。考虑维生素C对豚鼠的成牙质细胞生长的影响，因变量(指标)len是某牙齿长度测量值，考虑两种不同的维生素C类型(变量supp，取值为OJ或VC)，以及三种剂量(变量dose，取值为0.5,
1.0, 2.0)。</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>基本思路：两因素方差分析，最简单的情形是有两个分组变量（称为因素）A和B，A有s个分类，B有t个分类，对A和B的每一种搭配(i,j)，重复试验r次得到观测值<span class="math inline">\(y_{ijk}\)</span>，设各次观测值相互独立。模型为
<span class="math display">\[y_{ijk}=\mu_{ij}+e_{ijk},\;i=1,...,s,\;j=1,...,t,\;k=1,...,r,\]</span>
误差项<span class="math inline">\(e_{ijk}\)</span>独立同正态分布<span class="math inline">\(N(0,\sigma^2)\)</span>。
一般将上述模型用另外的参数表示成： <span class="math display">\[y_{ijk}=\mu+\alpha_i+\beta_j+\gamma_{ij}+e_{ijk},\]</span>
其中<span class="math inline">\(\alpha_i\)</span>表示因素A的“主效应”，<span class="math inline">\(\beta_j\)</span>表示因素B的主效应，<span class="math inline">\(\gamma_{ij}\)</span>表示因素A和因素B的交互作用效应。这样模型中的参数是冗余的，一般会加限制，比如设<span class="math inline">\(\alpha_1=0\)</span>,<span class="math inline">\(\beta_1=0\)</span>,<span class="math inline">\(\gamma_{i1}=\gamma_{1j}=0\)</span>。
二元方差分析的问题是分别检验两个因素的主效应是否显著（不等于零），交互作用效应是否存在（不等于零）。</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">data</span>(ToothGrowth, <span class="at">package=</span><span class="st">&quot;datasets&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>d.tooth <span class="ot">&lt;-</span> ToothGrowth</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">mutate</span>(d.tooth, <span class="at">supp =</span> <span class="fu">factor</span>(supp, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;OJ&quot;</span>, <span class="st">&quot;VC&quot;</span>)),<span class="at">dose =</span> <span class="fu">factor</span>(dose, <span class="at">levels=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>)))</span></code></pre></div>
<pre><code>##     len supp dose
## 1   4.2   VC  0.5
## 2  11.5   VC  0.5
## 3   7.3   VC  0.5
## 4   5.8   VC  0.5
## 5   6.4   VC  0.5
## 6  10.0   VC  0.5
## 7  11.2   VC  0.5
## 8  11.2   VC  0.5
## 9   5.2   VC  0.5
## 10  7.0   VC  0.5
## 11 16.5   VC    1
## 12 16.5   VC    1
## 13 15.2   VC    1
## 14 17.3   VC    1
## 15 22.5   VC    1
## 16 17.3   VC    1
## 17 13.6   VC    1
## 18 14.5   VC    1
## 19 18.8   VC    1
## 20 15.5   VC    1
## 21 23.6   VC    2
## 22 18.5   VC    2
## 23 33.9   VC    2
## 24 25.5   VC    2
## 25 26.4   VC    2
## 26 32.5   VC    2
## 27 26.7   VC    2
## 28 21.5   VC    2
## 29 23.3   VC    2
## 30 29.5   VC    2
## 31 15.2   OJ  0.5
## 32 21.5   OJ  0.5
## 33 17.6   OJ  0.5
## 34  9.7   OJ  0.5
## 35 14.5   OJ  0.5
## 36 10.0   OJ  0.5
## 37  8.2   OJ  0.5
## 38  9.4   OJ  0.5
## 39 16.5   OJ  0.5
## 40  9.7   OJ  0.5
## 41 19.7   OJ    1
## 42 23.3   OJ    1
## 43 23.6   OJ    1
## 44 26.4   OJ    1
## 45 20.0   OJ    1
## 46 25.2   OJ    1
## 47 25.8   OJ    1
## 48 21.2   OJ    1
## 49 14.5   OJ    1
## 50 27.3   OJ    1
## 51 25.5   OJ    2
## 52 26.4   OJ    2
## 53 22.4   OJ    2
## 54 24.5   OJ    2
## 55 24.8   OJ    2
## 56 30.9   OJ    2
## 57 26.4   OJ    2
## 58 27.3   OJ    2
## 59 29.4   OJ    2
## 60 23.0   OJ    2</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">count</span>(d.tooth, supp, dose)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(x)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">supp</th>
<th align="right">dose</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">OJ</td>
<td align="right">0.5</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">OJ</td>
<td align="right">1.0</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="left">OJ</td>
<td align="right">2.0</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">VC</td>
<td align="right">0.5</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="left">VC</td>
<td align="right">1.0</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">VC</td>
<td align="right">2.0</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>可见这个试验是均衡有重复完全试验设计。 进行二元方差分析：</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>aov.to1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(len <span class="sc">~</span> dose <span class="sc">+</span> supp <span class="sc">+</span> dose<span class="sc">:</span>supp, <span class="at">data =</span> d.tooth)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">summary</span>(aov.to1)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## dose         1 2224.3  2224.3 133.415  &lt; 2e-16 ***
## supp         1  205.4   205.4  12.317 0.000894 ***
## dose:supp    1   88.9    88.9   5.333 0.024631 *  
## Residuals   56  933.6    16.7                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>在0.05水平下，两个主效应和交互作用效应都显著。</p>
</div>
<div id="exercise-3.4" class="section level2">
<h2>Exercise 3.4</h2>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},\qquad
x\ge0,\,\sigma&gt;0.\]</span> Develop an algorithm to generate random
samples from a Rayleigh(σ) distribution.Generate Rayleigh(σ) samples for
several choices of σ &gt; 0 and check that the mode of the generated
samples is close to the theoretical mode σ(check the histogram).</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>基本思路：可以利用逆变换法生成Rayleigh分布的随机数。该方法基本原理是：对于连续性随机变量<span class="math inline">\(X\)</span>，其分布函数<span class="math inline">\(F(x)\)</span>也是一个随机变量，服从参数为0，1的均匀分布<span class="math inline">\(U(0,1)\)</span>，则依据概率论知识，若<span class="math inline">\(u\sim U(0,1)\)</span>，则<span class="math inline">\(F^{-1}(u)\sim F(x)\)</span>。
Rayleigh分布的分布函数： <span class="math display">\[F(x)=1-e^{-x^2/(2\sigma^2)}\]</span> 令其为<span class="math inline">\(u\)</span>，<span class="math inline">\(u\sim
U(0,1)\)</span> 最后可得 <span class="math display">\[x=\sqrt{-2\sigma^2ln(1-u)}\]</span> 随机变量<span class="math inline">\(x\)</span>即为Rayleigh分布的随机数。
实现代码如下：</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># s表示参数sigma，这里取值0.5</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(s<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span></code></pre></div>
<p>然后利用直方图检查生成样本的模式是否接近理论模式<span class="math inline">\(\sigma\)</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">4</span><span class="sc">*</span>x<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
结论：生成的样本服从<span class="math inline">\(\sigma=0.5\)</span>的Rayleigh分布。<br />
</p>
<p>参数<span class="math inline">\(\sigma\)</span>取不同值的情况：</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># s表示参数sigma，这里取值1</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(s<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>x<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
结论：生成的样本服从<span class="math inline">\(\sigma=1\)</span>的Rayleigh分布。<br />
</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># s表示参数sigma，这里取值2</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(s<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(x,<span class="dv">4</span>)<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">8</span>)))</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
结论：生成的样本服从<span class="math inline">\(\sigma=2\)</span>的Rayleigh分布。<br />
</p>
</div>
<div id="exercise-3.11" class="section level2">
<h2>Exercise 3.11</h2>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Generate a random sample of size 1000 from a normal location
mixture.The components of the mixture have N(0,1) and N(3,1)
distributions with mixing probabilities p1 and p2 = 1 − p1.Graph the
histogram of the sample with density superimposed,for p1 = 0.75.Repeat
with different values for p1 and observe whether the empirical
distribution of the mixture appears to be bimodal.Make a conjecture
about the values of p1 that produce bimodal mixtures.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>基本思路：先分别从N(0,1)和N(3,1)中各随机抽取1000个样本，然后分别按照可能性p1和p2进行混合，生成新的1000个随机样本，这些样本服从混合正态分布。它的概率密度函数为
<span class="math display">\[f(x)=\frac{p1}{\sqrt{2\pi}}e^{-x^2/2}+\frac{p2}{\sqrt{2\pi}}e^{-(x-3)^2/2}\]</span>
可能性p1和p2可以用sample函数来描述，利用sample函数从(1,0)中随机抽样1000次，抽取1的概率权重为p1，抽取0的概率权重为p2。
实现代码如下：</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>N1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>N2</span></code></pre></div>
<p>绘制样本的频率分布直方图：</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fl">0.75</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">frac</span>(<span class="fl">0.25</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAyVBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmZpBmkJBmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQZmaQZpCQkJCQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2Zma2kDq2kGa2kJC2kLa227a22/+2/7a2///T09PbkDrbkGbbtmbb/7bb////tmb/tpD/25D/27b//7b//9v///+t3mL/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAANHklEQVR4nO2diXbkOBWGlZ6kGhggGWaDhhT7AHHDzDB0GYipLvv9HwrLksryIv2StZQquf/pc5JKW7ryZ+nqaimZdSSr2KULULoIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgQUDVD77Y7dvHuWn04PTOjNh66rxa+PsUytGey6j18wdvOz4XNMg9EAVUOZ7uSnCaAqCaCpwe64Gz5/8qGLazAWoIZ98kP38fNZoWr+ud3fPhtSxTPY7tlv+lq0Z/eRDcYCVN08dfwx3ul/FB9PD3fraWIalEaGH1ENRgIkH9r02bV73sD6m7iPYwQalGyiGowESD20akAiVbOhoA171/vPn/4QtVyrBrmt+40GtxbEUWvlPT3c6n3K0CSs6v0IUxViG6Djjqd3NuhSlISAGlGB+j7l589d+57NHUP7/cyVNv0VlXC6Y7HaP6863FVAx90AxcngwvrE3liUhICmD1c6JC3JN2sZ1XNAXfvHDyvXrRmsecfmaHDd+sReHRPQis+c9yUzb9H+bu2+G5mGF4tHNryMp69WnvXSYN8qpg7bZnDNeiNbpbQni5Kum29kiCJd0by/ada64kr9kfF0j10jmsxaxDc32O5li3YyuGL9+Papawamg71Ke1QxtAwUa+UkK9YPAD6eyy/U7pd3Pf6Nl6rp70/8pVmL++YGq9E0Nrhmnev02ZOwNy1KFI2RvyRzruFy2DELWD7T+hieog9ehizu9VLxWtQ/2x+ttcapQTnSYHxsgw2KD9KsdlE9pOntLYsSrPYfauwoAGk1/OMfzsPIs3iFHtXX50ovqCqVLPDbtQ57arBh2uAPGpQfZmZlJzi9FAJqv/vb+ff/vVvvGjeomUQp7f7ryfOWpapFJTzuIgw7Jwblh7lZ6YMm9hCgj1/qAenxy7XKvkXDU+LhmGgmzWSUq/jIe1qvQSEGVY7c7FgI1fR0e8wE6PT50MeevpiWbd0dbNDEJfSf/qJnLApVKycWxeiKD5qbPQPS/mgEVA1BQbufD/vqSDMJs07lfpLxUKjxOa72YoEGHxdmefM6fvo8s2cCJMPQejGeiTZS1iORqi+RHlcOharOk17vo8x8LeOgmdl+CCfqrG7PDIhTVMPNyX+8idTI/m7MZ1am1Ug61KDZ+sQeMzjpRritRrgu8UNGYlXQTObQAYu+8PRL033PyvRdyBMxGTRbn9gDgKrzePxRweorYsB0nQznRA6m8fS0TJOrGt/2bTZoHM1/P403bE2s7wDVcOrNPx9k02pYgMtUExFbK6E3oFCDxjhoANSH7DLjmv1Y/dpIT1ap0HV4OsxNYmjZ7rdWwhFQJoOugPq6pEwoQFt0HjBtrYS+NSjYoCug/jeFJQqgLVmcq6xH4iCDQk4+qC/c16oKKR80bWKu5Q0MovxrUHDUZo2DVC/WDD2agAV7MaM/4Lne/LrP9j+7cB+UySAAJLv2E+/BxIKBXCzdkOMgWeU3rzesA0poEACSkbSoPGKVC0fS1vkBHrcFrFh5Awo1iKY7NozFsu+nSWzQnv0ygICj+dcFaDkf9BPUX74yQF37W53QdH7RnKG2mSm5EhvEc9LfanPS3+AiqCU/JjczJVdig7ErKM9P38yUXKkNpgCkb2ZKrtQGUwCSygcopcGYgNg0v2H7y3sWGsra7SU3GA/QMPjRshvGJmrBMwUgNnsgaQxGA8TUPymxjvv+r+2fnqdrYFdmMKoP0mZwz5uZTl89n36RqL/XAaUymAaQtpnp+OlztOXYpb30BpMAarWIpLmLt159CYNxAcnctLUzvrx7fPv07xReKIvBuHGQyE2fCebza9qMdmylN5gCkL6Zqebjo/c3kb/IktEgfV8MiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABlQFIbkotUWUUix0OhzJKslAZxXrxgPTN25vSv3RAodkRIJSMAIFkBAgkI0AgGQECyQiQLU0vAmRL08MhQLY0BAikIUAgDQECaQgQSEOAQJpXAChouuM1AArKjgChNAQIpCFAIA0BAmkIEEhDgECa6wB0egg53m6RnU+aHo6IoUpcYNXKw18mEPrN/G2AxIRZmfNm0/IEMwoBVObM67w8tfjWVazsnNIw5YM4qKIB8S+mPQa9OygQUP9LuYD4SfCCTBP9UD17moMGqFwnfXpwOKxAnt69aIQho3mmAzoUDEieVmCrPrXy4I3JlQcDKo7QAlBtBqSdT246ysz/7lh3FYCqsZGYu3nxlotBpnoWA1BZiBY1yKI8NaiwOuRVmHo8MzmWD2LdAlBZPb1fYdTLL42Bku+98esVIDnUKMwNibKcHu4nL/4MzM7vegVo/FEeoItlZwBUkKP2K0jN5OtdTcGA530Nly8BlTTi0Ica9xyAbRzGz74VR80lBlRQJRpLUd0+8/e9VeZpM9HND2PZ1IDK6cy0sdjj8LIky1BDBYo9yjiAxNVXBIi/VM5lqFHdxQLEROe+AogVElNrTeyOH0BuPc1SYVmc8LRtNK+FhquAiqhEk/mgmyfwig4VShsPbo8H6FDI9OIF4yCmxc4EaO1ao3cee/u4pduisQim2cJVxXDS1waoinGynscdMXP/rkYcRQHigXTE7OCFxv69XEAxjh70AGRtW3JIVhIgp3dwQT/1ggHN3gW7qlirGvb+vVAn7TBhFm1OGpM5D+qdbySVfEoQbVVDbVd4aYAi1iDnJnZxQloB+kZ2+1zZOvtYqxpqu4ILIGOOmebUNCd981Tz0byNkGlVw3M07wFIzFqv5czybCbSunnxZmjLfJBPdvarfACZNlblBsQ9MAcUsPeli9+LdQOhKQtZny5Vg6qgd5c7ldhhlKrHQfO9iyzrQv7cB8F3PLpmZ7vID1BnAZS+Ek17seBXvrgUF49S55E0U+5Ib1v5AeXKDs9zLAEtyBCgCaDB21wYkAhxgjx05wLIZSJoBZDcjH85QPLdJnXgXnsXQC5kJt38uM+cTZQTUKOc83GXuBdzI6MDkn9Y+CDJKKS4znekzZZZ1uads7NeEQ3QIcvKkMhfG4ElHmo4DuPdAOWYtlaA4EyPT3bm/3adSlSANI++3s1niqTzAXIkowBpf7hqQK7THfEAjVUxMaHMNciVjBnQopEmJqQAjXWgcECLqyyTjjGUdajhHkKvADL59y4toesBZPrRpSWUE5DHKNUPUEpCGQGxMB9krUFM+5HvjiJnlxDQ4SDni64ZkNc8xwZAiYau2QD5jTH8AR0SDV1zAfIchG0BlGbomg2Q3zzHRkDX66SNcXBUQCkGZnkAsUyAxNx+1Irkl9XGgwXUFHISQNPOsYvdmXlltXELHvMPoT0AzesTi+urfbLauIFqSwAUAOiCTWzLFryNbWszILF4xlg0Tilr0Lh+lQ+Q5qvjuCJPH+S1BY/J4O0CgLpohzX55eF3sMDwKAPuMghQF8lXp4yDmPza4KUAZfdBvtl5LcPHB3SIEljHCRTXsgvyzqGA1ORHOKIkgaIMqi8ISPPVgYiSdPMqEikAUDCiFIEiY9pOp4sCclzwjQXIqQadQ8MSAM04bfn6QpxAkU2fFbsCJQGEA8WXp9S7R65eBAhoI6CwjXrXpEw16KL+eCbPkqcBssEMviRKJr53TICiXu51AIqnmZcACA9WA8y8AEAOQ40AMy8AUMBe2NcBiGoQEl7VCDDzEgBtH6y+FkCvUAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgSUB9Awl22bIWnQ2VcwByF0Attxxzzft5sFULvv7762lIwfPtPYCMEcZD5gIqbp/9v63oelsgASZ+6YV2PFVKXt3BmUg9Bwlqjl/4Udv1XhjD7IXEXcbt+Wg1B9+3sroONb/yPsMgIyH5ovCo4XAsCx+302dh/UvPnXg++7mvMBssxji5qB6geaCecNyA6o5iueTkevj8oGqAE+GgOy5cCFzxGtb9xqqq5cgKxP36mJoZWUIRMAaLDgd0xbakDyBe320/VcnDQ8n6+Wu1ssdy8egZ+rzlODwAmxuJtHOSjZa5BYGi6wiR134OnDQBHmIAUiae6mtPVhF2UBJGu/hUANhho4ByE01GicBiy6aLAKRICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBBQ2YCOO7HWHvj+4BCVDUjumnLd25FChQMa9m167iqMq9IB8W3fFz3uqnRAffP6VdirXwNVPKDglwcHqnhA7T7spYKhKh5Qdftfv2+fRFbpgJo+AvI+ayamCgd03PHaU8HNm+lUNqB2P/if08PlDo8tGlDvoEUPj76mkVBFAypBBAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAEC+j8PKbY4Y2lONAAAAABJRU5ErkJggg==" /><!-- --><br />
然后改变p1的值，重复上面的步骤，观察不同的直方图情况：<br />
p1=0.1</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>N1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>N2</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fl">0.1</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">frac</span>(<span class="fl">0.9</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>p1=0.2</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>N1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>N2</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fl">0.2</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">frac</span>(<span class="fl">0.8</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>p1=0.3</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>N1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>N2</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fl">0.3</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">frac</span>(<span class="fl">0.7</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA0lBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmZpBmkJBmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQZmaQZpCQkJCQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2Zma2kDq2kGa2kJC2kLa227a22/+2/7a2///T09PbkDrbkGbbtmbb25Db2//b/7bb////tmb/tpD/25D/27b//7b//9v///+DeOsKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANOElEQVR4nO2dCZvzNhHHte0mL0cpG+jFtQFaKLBeaKEQc63Jm+T7fyWsy5ZsSWNbGllJ5v/06bvZtTXjX8aj0zK7kIJiaztQuggQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABSg7o/M2WPfzirf/8JbM+49k67ZjUB/9IaCM5oEr4uNEfT5/YnxFtXQeghn343eX9J+xZfa7Zx2/t54eXxHZctrTFZ8/xi5QaUCVQHLcb+fG8f+R3QGKn3bakBh+jlRiQAqL+0fr3LmnUh2yd94lNJQZ02m3Ev5XhZs3Y43dzC5rgl8tWa+xprqmwGxkAVT9oCU2pxs77/sCFgE67SZZmuJEB0IV/rxuHI38dXEvTHlQ9K8e6o37vu2KXrcYXQJaxkWXLlu1GHkCuzHD62lVAPQR0OX/lSSrOaPVkIMuY27Jlq8YC5E7SLsfPv3FdCv/2lGdtfcRE5Xf63PN9j21pZqNDTWMuy03bmn3pbRluIFfzKiecxtWY9sE+W/+S8XOeL40orfK0EcbVfONpTljGHJaP714ujXBR2DLdwG4oVqKhuB+lhvN+fCn977hXTYtW/qbxJN5xQ7F2N0gtYy7LXKefvEhbthuIXQ3hrWr/jy5RuqPEjzxun8SpT9ozcdSO+3r8nicLDWx5U5BlTH5QJo2DauFja8t2I31n9S+6Aymd9nRWeVD3amO6Mp3VXimn33k6KiNbw9TnMqY+DEwetxKxdehkQOdv/9T9/L80PfPGuhnO+y+sS1Ne1TIgjtvIjoplTH0YmlQ5yLI1FdD7z8yG8PGzFG158U3xJpm8R+zsqvmo6/JG0CJjujRusndA33qmLWb44hQfqmj9Pn1q++dNCXNkpYX20x/MQqVTtU4o0QYdOWhosgNk/BIEVInGwXk/rIHq+Ob8sGJ5sgoVTvXfpa8WW2rseWSS317Hj94GtiBAqvk7rjrt7L9QZmukar0y23jCKVlF8Yt5jR4rGbeDBiZrPcz2OkhBYUCcpqP7l2ZI4c/eMgY++VrSi435LVu2mMsZQ41MX41MYfKfSubSavH41/u+0j/9zHfdA5++Xfpt+Iz5LVu2JgKqVCOYQ1Gw3J3zKeLdq24U2dentn2yjmrm3Nt+Y97evPV7CJC8xdqKUEZL2536m+5RNdPGd8aq2I/bIl8XB+AsQLHGpCBAbVdBGajZ9/WPjcpolZpGkN8SgyX7lef9ZqG3PaAMxpQh/58GgNpY0qaahTMrKugnDjA6NCeCoo1JTQfU/qSxRANacnoXrhNPjjLWa3IOah38QoeQzkH2LQYrugE1L4KSDN+D7SBdizWiRpOwgFrMmxXO+4dftkX+a/HUlQMQnjFVvv9PEpCq2sWY4HErIweYB/SXqcJ+8TyrCxCaMah8uyUtg0fOOkEt6UCZvO3GfjR7lkxrFqBYY2D5SvP7YjmX1KDbgg2MGxJAbz7rkqMCAI3Hg34YrjfvDtDl/GuTkD2+6Cvy/adtevwYZ91UVmPTxqS/Mcakv4Yc0ZN+rT5EWNSR2RhCiDLRLfnVxTUdhmAL2RgOIDVW55sJTmoL2Vh6QEaJeQDhGksLaDCRJBajvLIUDVq3rQzGUgJqPbNKFD2ThuEAGthCM5YQkPK4K1HO5r7+8fy7N3sWLJExZn8ZSMYS5yDD6ZqvveA6ff52+ilCFWwCwjOGBaite3WH5PjRW5LJWK8tVGOpazHW8elaJc0mzWz12NYlgzEkQMbMGZ/kPb57+Wf6tfbKFq6x5O0gOa9ujAfz0TVjPDu5LWRjOIB0dSt85n2k1weMZxGk87jGso5NXKMIECACBIgAASJAgAgQIAIEiAABmgdIrStGaRYXqlmAuucdvc+t3Z7mADJWTKdYKn0dmgNIPnsj1NzNTUYRBGhmDupWcVIOckpvj3E38UPtIFAECNACQA3CNGm5mgeoYuyJP1dlVPiZxRjLG/SzrPGHrOTD6qtV8+xwKBeQiBv5IOBqDcXCAYlFwP+5UAR51D1mK1EZpXRK5phHZQPSa6Z9W2TkWHRaNqDcxTkMECDAwJUAqj21GAHKW5zDAAECDBAgwEDZgMBZjTsHBM9q3DegCWPS9w1owqzGfQOiCIIEz2rgOs/rhw5QpqGzxLMayIBaOj2gPLF0Ve2g6wWUaTxIAVJPFV0TIKzihqVLQAcC5Ctd0pGhKgHhR23RxQ1Ll/cXJ6PrM/Q4uj5ABx06BGhcuspB6jbLC6ht4mwSFoeiHtBBV2Y5I6hmLHrZDzYgZgA65AZ0ScAIu6thRtA6OaiOW+SbGRDLDIg/mvbs3dd7dnHJZeegrs5HbQr1RfOOqCQTsTIhM6CLzkmINvUPp12KVVG5AV0yAlL7FcQtbEEFxFyAWG5AvjnTmcUhiDkjKBOgbk/Ngqt5N6ADyxxBiYpD0MqA4krJMGDGVk7SRRY3KNoDiOEDOu2e0ryEE89TPYi4DqBpkisTm3Xm5q8GUC13wPUsUlwF0CFXV+NJvNDS3w/jRyg0uWdW+8Gf9QBVj2/8ZW/d29nG4oDU25Nyz81bVdZKXQ3+xjz+7gx/kl4zgrqu+6qA+AveAl0NWdFtLuOF5OPi0spCs1Y7qNrwzceB/SxbRm2n3/9E5lqAcCsHKXHtiK/piCnVB6j7A14b/ipa0nYvzADU/YfXFLoGQIP6ywUI7ybry02yL8ctA/K9JrlX113zY8Rwc9iGXgmQt+Y2BL+aLq2b/RgKCAg/B016Thes5BIDOuj8WwCgaRW851G6VANmgxJk/VQIoMBjhIuKW3a6faGzACE1hczVHevXYiNA3WqgCYBwgqisdtAgEvp506sDhPTEoZ1OGBt2uUKAkGp6o9D2Jnt8q+JWCM330codJiDZ0SoIUPPwUvPefLaJQ8cSsf6W0n/T+Xd9QPrt0PmmnvvYMH6lmwv6b2MOawHiDUUOKLh4IekTh2NAFprZgJCTtI6gKjBqn/aJQxtQFzilAlI5KPR+x8TPi/XZpWuDW4D6JF0GINlUDK2iSvzEoW6/jGsxIymXBAgUQgQN1mZM4+D9A9Zgy2SlfeJQXJKOGKYbPsUCkn0xYH1r0icO7ct1hc/sWwyBkC5Svd2kjlxrPw+QmWpc4VMQoEYnZzW1PLeUJeNBi3PxCoCM0bLA3Pzk4iYeO1w3XzAgoweWt6uRGBACIQ0o0U7RBGhScdMOJUDAoRiA0hNaDZBj1XPRgMA50znFTTsQBVByQmsN2hOg4FHm4E9CQKKlWtY8zbLizE5GSkCiTycyUbpZxJUiKJIDCOiQbHDo9gDp9Jb1ihIXF83hxgHFjosBgC5JHxa/OUDGtFq+K0pbXPTIahDQQT8snvGKJpQyZ8AMXtQbC+i6b7GJSxGuE1CCqeeJSzIjAaVbLDRz2id+6nnYyUCKoFVa0ikmDl0J6GYAJZh6TjK7My0HJSKUOYIScQgDUisiZlxZyOM5B0dPPbvDJzUgFUdpEM0rJHLq2ZOAkAClacLkbAf55t+xACW5uIyA3C0gTEAprg65odj3PqwlZDkAzV8sMOmKgprfUOy+SuVpRkAa0zwe4BWFtKCaN77K0UB9JkCRiHAbin2cp+UwHdBB7hy8BI3zioKaHEGjiFkVkDkWMz+g0jQU2fUJBRC965k0EgECtBBQ3EK9a1KuCLqOjOxyPBmCODvQOAnmn9HOTWnnRgAt3wDlPgDBndXFdm4C0ISuxmI7NwEoZi3sXQCiCIIEz2ostnMbgCI6q3cC6A5FgAARIEAECBABAkSAABEgQAQIEAECRIAAESBABAgQAQKUCZAYzPYOkTTBna/C5wqFNl47blnMK3bzADrvWwC1z0++9UzjJRQ+VxYQGH9p2j8Br3oIKg8guemOZzpWDlR6d50JniskthD1/E0WHjERnDMHeaIEJuA/V6h+/K0X0PFd5Iv3cgLy7JovrwGYBgjsuN+e789BzQd/30W9tzEjIN9AtgyOUIgEB8H5TeQHVPNJzpjXqeQD1IRyNADIe+7lAmwfWj9MCM+QsgHyxwB8i4UmUcTZAUCi2GU7swmhA1JvaA9srwcm6eDWfLVa4eIhILlHpOpMEQRvEevfXC50rpI/guRscPG32HEbqkfCDcXwuVKBljRPUcaU8GzlAaTuAx+EOtTVAM4VCnU1GrCjEhR1VgERIEAECBABAkSAABEgQAQIEAECRIAAESBABAgQAQJEgAARIEAECBABAkSAABEgQAQIEAECRIAAESBABAgQAQJEgAARIEAECFDZgI5bOek+YYEHlsoGpJZOTVnggaXCAYnFmzFLDKNVOiC+BnzV7a5KB9TeXj9fvsAwgYoHFP3y4EgVD+i8j3upYKyKB1Q9/jfiUZR4lQ6oaVtA8/eaSajCAR23m/b/VXAFJ67KBnTei/xz2q23eWzRgNoELWv40LMayCoaUAkiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgTo/3uEDe7H4t1+AAAAAElFTkSuQmCC" /><!-- --></p>
<p>p1=0.4</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>N1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>N2</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fl">0.4</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">frac</span>(<span class="fl">0.6</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA1VBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmZpBmkJBmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQZmaQZpCQkGaQkJCQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2Zma2kDq2kGa2kJC2kLa227a22/+2/7a2///T09PbkDrbkGbbtmbbtpDb/7bb////tmb/tpD/25D/27b/29v//7b//9v///+i39FPAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANI0lEQVR4nO2dCZfkNhHHNZuZWY4QtmFzQGAbEo4A44EEAm2OcXrp9vf/SLEut2RLKusotT1T/7fvrbvHVsm/LpVOy6wnBcWunYG1iwABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBCg4oDOX9+zm8+frO869q60Gact/pn95ClwRbyKA2oY15351fEeCdDE1nkvPt8WJVQaUMc++LZ//9YkwvONAmhqqxWf9+xNSSOlATU3Dz33GcOF2ps/4ACa2DrvX/1r+O+0uwtdFKvCgM574eDqP6EhAOHEoKmt431R11EqDEj/fI34MfU3CYAW5Gtqa7Dy37dDkP421lYwG+iA+NFCQDxYac9LAvQjEaRH04mys4ENqOVs3IDOf59UN91wbfNOZWw864++SmkOiP30qf//l8wVgyxjM8uWLTsbyIBkXHACOn3lSqCdAurPv/N4xByQiEEqVgeMuS1btlosQNPA2TIlUeFYZ/7Wdd+d+vV5tobmkwB7+tTze8+CtLyrZg7IMuay3KkcKltGNpCreT+gzlUQGv0l4w7yru/EZY0ngk1sKY9yeZBlzGH5+Pqh78RlwpaZjQoNRWcRO+/nd335jueqGxxDftN52sZTWw376Ik3FGcALGMuy1ynnz1IW3Y2ELsa7eg1DkAyO0r8zCFaiUvf6JyJs3b8wuMPPFFoYuv01lOLWcbkB2XSOKkVP8Ngy85G+c7q33QHMgiIO/VFg083ZmZ1rlSmX0/Lp8fW+XEIWx/N3c1KQH2YmDzey9xapy4GdP7mL+Pxd5+7/T1SnRWUzvvPrGKkctVKZ9DRt4wx9WFqUsUgy9ZSQO8/MRunx08yG2IyFf5Lqe733dTHNB91X14PSjKmU+MmLxnQRc+0xYy8OMXL9JDv08d2/rwhIUZWWBg+/clMVGaq1cEk26AjBk1NjoCML0FAjaidz/tpH7AtMOIyqVjeWImKTF1+S18tlmrs3cwkL17HD58mtiBAqkHRzpowRbrNZmukGXJljlKITMkqit/MY/ZYwLwdNDHZ6srvcRKCwoA4zdNu9vs5G/PR+qs3jUmefC3pZGN+y5Yt5sqMoU6Gr06GMPlfI2Npkzy+8/5LpkeRT7/w3fckT9+k/ho+Y37Llq2FgBo1gsmhKFiDQyYO2vHu1TiK7OtT23myzupiyrbfmLc3b30PAZJFbKgIpbecdq/+sRv7zYlhs+EDEufHZAeMApRrTAoCdNppAy37oT7sVERrdFdU/EoM1r3qTqaOGl8AVTCmDPn/NAF0vvQCu8RRO+X06TMzMR6UbUxqOaDhSGPJBpRy+eiuCy/OMnbR4hg0ZPAz7UI6BtlFbEmeMxtQcR5UZJIDbAfpWqwTNZqEBdRi3qhw3t/8akjyP/f5MaiCMZW+/08SkKraT7wGO95Lz2nDNYM/TeX2s7b5UrkAoRmD0rdb0tJ5WuFOUEs6kCZvu2XMXEUByjUGpq8U3xeruaQG3RZsYN6QAHrzVZccrQDQfDzox+F688UB6s+/MQnZ44u+JN9/PIRHx/BwaaEbWzYm/bUxJv0VlBE96TfogxKjs9c1huCiTHRLft0XX8vktoVsDAeQGqsrvJbJbQvZWHlARop1AOEaKwtoMpEk1ls8shINWretCsZKAhpyZqUoeiYdwwE0sYVmrCAgleMxRTmb+/jn8++f7FmwQsaY/WMgGSscg4xMi0W5XKdPn04/R6iCTUB4xrAADXWv7pAcP3wqMhnrtYVqrHQtxkY+Y6ukuyszWz231VcwhgTImDnjk7zH1w//Lh2FRlu4xoq3g+S8ujEezEfXjPHs4raQjeEA0tWtyDPvIz3eYKy1l5nHNVZ1bGKLIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgSIAAEiQIC2CYgxVivjGwV0OBCgkAgQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBGhzgC4PQhZJDra3NUBYyXnNECDADAECzBAgwAwBAswQIMAMAQLMjIDQmxabB4TtSxsExJ2GAIVsDEwIUMiGAxBeKNouIMlEA0JzpDHZ0y51aztncogSgOQjq6wiILl7eO6z+bUAsYMePqgIqC/AqGIRO6iSVhWQRJTxOFodQMwExCoC4o+mvbPeO5OVHJJUwVKADtUADVFaPTvcRbtQ1RFFXqoMQAejMsOwpg9OuxLbFdSPQfUAqf0K4t3HmRye2AxQz2oCajcIqGfogJpLFPFX86edfFFPoJ7DB8TmRawGoOku/E4JQK3cXNHz4DU6IOaIQX3NdlBIHJBC49spMCmXMbWfDxA7INWhsYDUizl8oTwN0PKfX3vL3IOwSplMc7h13gzS+xd4hOZB6we0TJLhXa/DdWZyl4sW3xrTp7ti0PUB9YLR0J7svFUdLiA2nn4NQNwrWsQNzgMXTW/NF2/DgBgyoOb2ib/srckaNisEyO0Mxiir04NwazHxxjz+7oz6LWmLhzEKNj3NGNq4EiD++sQrdDVsQAdPOLFGD68AaChbfPPx0H6WY0vA3xjAAaRGUvRQ/dWC9FBBhV/TAb/1KC6L9syE+s4F6CB7XBYWFyCE1nRceuBrTiIBXW7c/m4OiC0DVN6LItPzvLU5cURxESBRqFjIgy7FDhWQet9f3g5yOYCYJfMkdeM+QMZR+baQEaRL7K2XDEhFI+ELh8usF9PdrOsD8nav0pJbdra68dFhjNs1HOqwEkAxmw/6WksJgGQAudRnYwySX4/fLQJUvi00ppf7Hq5JcsvOvgCaIZhV7tcG5KugUpNbdLYAdCgJqPjAolHEwAGzmOSWnW3fmoWATUOzPZ8aPMq4gcw7ApsC0YCYD1Ck36wDUKsHyrwjZs8a0FDIbp+aQGVvvNS4zJi0qJZLAypc0xtB+uah5b350MThGMbLzGpMALmizHoA6bdDB8aDynsQA293PYC4e/DbDo0otpcXrZaKQeDtLq+79BFSNa89qAmN2uu2gPec4oASjpAAqRgEvN9xeXJLTsYBhFmLYb5T0nHyxgDVTo69IEBJI4oMKQah1WLB6Bub3KJTsQCVJKTTUm83aTPX2i/N2jj8sxVAnQ7Oav1PZnLweYdtATJGy+rMzeMCKln1yKSMHlidqeftAQK7oTHJLTiPjUNiGIAKEroioNJYnhcgBCwEKAJQOUIaELiwJSY5+LStASqm9QAqdWNXAeR43qJ4X2zDgJyrxMp3VlnfRz3kkHFHhZNbMBJdDNAhu2v/LAGppTSbBYSExTrq9XjK9gChdTBmgIo8qVl/RLEOIL32aiWAYpKrA4gfFXlSszYgxD78cwGEjcUA1BeYh669PggfyzUB5a8Pip9pzwOUPz4dc33+6o6EpQhbApS/PojVLmKHbEJVPShhtU8BQHmEImNQyvqgsf2ou4+1AKmGYh6huIuT1geJXOq/1QQk/2UOnlVoB1m5vAagLEK1ADkeV6kHKIcQWkPx8nwTk8+kzB5XqXSUsDAnGVBMQ1EVrMPlsa9D4rLwMkephNCq+fHHO2hUh6Q1q6WOUssZVkPR9JsLoOpYTEBpQ/gIHmSOVa0HkCE0QP6GIrPtsw0IBRDcUHx+KtwOen4iQIASAeUt1NuSqnnQdUPyqPh8I7BINASPZ1ewUeCKRL0MQBkboLwIQHBnNcfQ9gEt6GrkGNo+oKy1sC8BEHkQJHhWI8fQMwCU01l9GYBeoAgQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgGoBEqPZgTGSDtj8CrpeKLj/Gt+4hcW/bLcSoPN+uP3Wnz2++0wXIARdLxMJD8N0w19DL31wqxIgueuOdz5WjlUGNp4BrhcSO4n6/yxtRE8JV41BXh9Zcv+h64Xa2y9CgI6vk/avqwrIu22+zDw4ExDcdn9IIxiDulf/3CW8qLkmIP9ItnSNsIMAI+G8BAUBtXy6M37f9YqAunCMBgEFru97eBfR9maRl05VD1Do919SxMIzKSKFMCCRevQebfiA1Cvag/vrLQjSwP58rVre4r99iT86VNfyoPAesWA1D1yvBGzUy1NYaxE73oerD6ihCF0vFW5J8yhlTA4vVCVAqgT4EbThrgZ4vRDQ1egW9FZmos4qIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABWjeg472cbc98f3CO1g1IrZpatrYDRysHJNZtxi8sLKi1A+Irv6+63dXaAQ3F65d5r37N1OoBZb88OFOrB3Te571UMFerB9Tc/i/6AZSSWjugbmgBJew1U04rB3S8597TAIs3MbVuQOe9iD+n3fU2j101oCFAyxo+/JgGqlYNaA0iQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgToe66e9lvozkTxAAAAAElFTkSuQmCC" /><!-- --></p>
<p>p1=0.5</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>N1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>N2</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fl">0.5</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">frac</span>(<span class="fl">0.5</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>p1=0.6</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>N1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>N2</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fl">0.6</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">frac</span>(<span class="fl">0.4</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>p1=0.7</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>N1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>N2</span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fl">0.7</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">frac</span>(<span class="fl">0.3</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA0lBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmZpBmkJBmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQZmaQZpCQkJCQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2Zma2kDq2kGa2kJC2kLa227a22/+2/7a2///T09PbkDrbkGbbtmbb25Db2//b/7bb////tmb/tpD/25D/27b//7b//9v///+DeOsKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANaUlEQVR4nO2dCZvrNhWGNe1MLkspE+jGNgFaKDAeaKEQs43JTfz//xLWZku2paM9iud8z3NvJol9jvxGOlotkx5lFbl2AmoXAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEDJAV2+2ZG7X7yKd+c94frgH6kdLXwN778k2vsUSg6oYTwexLu8gHRf/fkT/X0SpQbUkQ+/699/Qp60T9vZ+zy+WvLx6/D+7jmlk9SAGpa80+5B/XD2NpOvy+Gelq7EP0ZiQCKR4mX8ME8EWvPV/3uf1lliQOf9A3tt1FS25NHbkEO61ny1hNx/5+3MlowCgM77e7eK5XIYLu9VpizIV/ODyUSo9GQUANQZMtDlr7Mr6YZzmyeRsPGo35uudzW30kz0ADlbeNZ86ckoAKhZDwrnr9c+beeA+stXhphiALQa8TRn6541X20uQCuBU17H/MjfrF13J46lyTrtCKuQzp8bfu/VIL36g2jO1jx3QwvzefKlJCN/Nd+tV7vdw8qHjfyQULBPfcesNYZ6e+ZLxLrzSjWmOVvxfHr33HfsNOZLTUb+hmK72nC7HJZXPX1GU9UNl8s/6Qxhd+6rYQ3FwzLkac7WPFOdf/LMfenJyNjVEGTWQxBPjhA98rR7ZKc+ypSxo/Y0rafvGaLQzJfo1yxxas74G+FSOahl5w2+9GSk76z+RXYgOaBFiOCimXrSkKcbNbEyVSLR7wydh4UvQ2dVMyDezFyedvzn1A51BnT59k/j3/9L01vutIJ3OXyhYRSpannmO+0iOw+aM/Fm7lLEIM2XK6D3n6mN09NnKZry7JeiTTJeRvRILvmI6zLmoCBn0hp1OSVAFj3VF1HSsio6fDCk+/ypnj5jSPCRFhaGd39QjfJEtTJ4RTtciUFzlyMg5UMQUMMaB5fDvFZoYxvz/aJiedSMskRNv6WpFgt19rRwSYvX6aPXmS8IkGiSLqtpPfoHSm2NNEOq1PYkSxSvoujFvESPXyzbQTOXrRzSe5mFIDsgSnOlq5lm+OLPRhuzNJla0sHOzJ41X2QtMYo6Hr46HsL4S8NjaRM8JvV+qojPPzNd9yxN34b+GiZnZs+aL0dAjWiYUigClqHD7CDavRpHjU19aj1N2lGdT9k2OzP25rXPIUC8iA0VIc8tQxfnb7KX04WOuTTkx4PJl+AM6AUo1hkXBGhovgsHLfm+/LMTEa0RUxb8VyKweL/ycngITO0EqIAz4cj81QzQkJekqy5wFkdk+vBBP58cFO2Myx3Q8JfEEg0o5PQxuzqeHOVsknMMGhL4hcxCMgbpRQxWdAPKLwclaK05tINkLdaxGo3DAmoxY1S4HO5+OZj8V/A02QqgfM6EffNXHJCo2tk43WnHcw4wN2e2KbJ98NznGqBsziD7ekuaZx4+wwW1pC02aduN/Ch45soLUKwz0L6Qf1+s5JKa7L5gB8uGBNCbL7rkqAJAy/GgH9rrzTcHqL/8WiWkjy+aTL7/dAiPH6ddy3QVZ25j0t8oY9JfQwmRk36DPsyxqqOsswxZlLBuya/61Smq9L4yO8sDSIzVGWad0/rK7Cw9IMViGUB5naUFNJtIYgtfXkiKBu26rwLOUgIaUqZZZD2TjuQBNPOVzVlCQCLFo0U+m/vyx8vvXvVZsETOiP5jZHKWOAYpiW7p2guq8+ev559mqIJVQPmc5QI01L2yQ3L66DXJZKzRV1ZnqWsxMvIZWyXdQ5rZ6qWvvoCzTICUmTM6yXt69/zP1FFo9JXXWfJ2EJ9XV8aD6eiaMp6d3FdmZ3kAyeqWpZn2kV7uctyswROf11nRsYlbFAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAApQE0LXxLYq4m+V2RuL/KPGL3xgGNe0yY9gp444CUO8dMi8wCAVVcOn2Sxe9BZuoMhSwU0PF43ACgjDloG4Cm9dGpY9BWAI1bkhmXub51QLnMISDotE0B6iwLlN46oIaQR3p/uVLhx5ibTtsIIHqzOd+0B6v5NbF8wzdEwIbims57djPUf3rMQQaN241wVIqVmOEOetpGAMl7xwzbknmbE+cMcLYCKIs5BASds0VAbcJabJOAUppDQNA5CAg4Z0OAssxqbAhQnlmN7QDKNCa9HUCZZjW2AwhzEKQ8sxo3Aui8d9gmKcusBgPEBgJqnGBV0tMSEn1vfigg9q/KUQ89PaGM4saDjoLMDQDiiCJuR4sbMGMZKdh3HmnpobemPZn2EPc353oOkUGa/lEvIBqAORlTI8fLnMc5xwnQsd4gfd6n2K4gGtCxtopsAiT2K4jIPn0QIDIHVFcpWwAyjRV6mnM/4zYANVNFHdUUCgA0L2KVhaFFDkpkzuOMOaAqc9DVzJEpSIvmUGU1WUWAppf6AJ33j2ke+Ol7afT4FUAVEbpyDloH1Fd0W8N1AbHDVwBV1CtTuxqP7CGTuTY4Nx5+K4Ca+1f6sLfx6WxeVgKHOwyAeIVWGSD2xDz67AxzkOargrp082L86CUg0aCuIgxpgOjD5CxdDQao5btwJ1nECQCqIhMpReyBbj5u28+SAhJoksxqiCyyDuhYSSnTxoPunq2P6aCAxBPcksyLKeHmFgDBSpyDTGSUl5sDRH/vh365iDPI3K0BAlduULFyaJ43dAdkKVtTbV8XIMMjmUPNQQceiS3ryOZQfIpipVTzKTb09shB1rLFXyoDlGLzwYKACvVnRxexz+GamQMPtEdnhyBNykzDTi7My+elxiEjcyh3S7EyeAgAIuPxRDublAfkMmAGPx7TERBIZgQku7MKC6IMYDu5i5KfC7AcugJyzUH9jQEylUPP4Q45G+8Sg5TSpJctUmYaVrE/FLL71yausk8PqCfzPKO+5M9ESpC+e25pb77AxKEXoH5aHXNVQPLp0CWmnt2DND+8CkC0oUgBuS1eiLvbxxPQWvC5Xg5qokbtnZLr0I2fARLxWNd1YhDwfEd3c5ZjwgDNXqSVsrVYzmdKKsekAMQaU2UBOSjJ3T6egIi5FqsOUIq7fVxGynRA4oPVjJR/TG3WF7NG6CT3ajiNc7gDKtaSFk83aW0LzJLc7eNGxgxIL3D5x9SE/U4GZzGts6o0OSgS0OJdZkLcvNJLt83NJ7jbx7EbXxsgpQdm7WrE3u3jPFIGAlIainkJSUBgdLFbcRzucO6lrgAyse3z5qE0gGbmzF9HADK9wF6jVBiQKxkJyKHR1PdZ81BRQO4tRAnI4ShuOCLNLlfkMF/hY874bS5AGQklNmw159HH8AXUy1te014OdEWJzXn0Uv0ATSNENw2I5ANE/9oAoIBazANQpsGPcoC8xjk8AClmyVjgilxRWnN+fQwPQHr/o+f5qcQVJTZXAtBRTn7cICDiN84RCIgRuklAs754PkB96sqsDCBSDhDvEWe/Il8r9uEObaKvACCSsDIrMe0T0EKMAnRMWZkVmPYJaQDFATomrMx8bIQM2geWrWBAskuWLFb72AiZ9ikNaMxI1wDkm4NEbL4OoFSVmWcM8pr2YVk+4iojAaWZEfKz4TftI4cgrgUoCaGcDUVRvq4BSMTqBITyAoq7yqhTeUaKJ5SxoRhTfaUCFD+cn62hSML672kBOU332pWlmhepuj6go4BUCJBzQ5HwNkgdgI68XV0CkFMOGjvuFQHSlQ+QuaE4809uQFkAwQ3F7Snv6qMNCAEBCgQUd0/QLalQDrpuQNblmfI8QALcwIckMeJ7xQgo6eFOG6AEutkCILizGuFmA4AcuhoRbjYAKGIt7NsAhDkIEjyrEeFmC4DCO6tvBdAbFAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIUBlAbCzbNkLSQXtfgRa4oB3YTjvi8LxdVUUAXQ7D1beWlNHNZzobIdCCsAMMxHTD17bnPqyoCCC+5455NpYPVdr2nYEscLG9RC3fcz9+s8IFY5A5i7hdvs0CV3v/Wyug0zv/LewKAjJvms8TDk8EANvuD2bsMaj74O9734c4lgNkGcfmOQPKH9BIOC1AdkAtnfH03Hq9GKAOiNEwIJsFKngf0fbOLaeqKgXI+us7FTFoJoUZAQAxD7Zt2pbKDUg8oN26u55TkLZbEJ6oLFfPfwK/UF0mBwE7xMLVPGRByp6D+NRwhUXstAN+fbChCFoQAlrSNEwp88MuKgJI5H4LgRboasAWuKCuRufUYVGFnVVACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgJUN6DTjs+1Rz4/OEZ1AxKrplzXduRQ5YDYuk3PVYVpVTsguuz7qttd1Q5oKF4/91pTmFrVA4IXJ+ZV9YAuh7iHCsaqekDN/X/97j5JrNoBdUMLyHuvmZSqHNBp9zD834CLN/OpbkCXA4s/5/31No+tGtAQoHkND92mkVFVA6pBCAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAA/R+piRYq/Um0vwAAAABJRU5ErkJggg==" /><!-- --></p>
<p>p1=0.8</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>N1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>N2</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fl">0.8</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">frac</span>(<span class="fl">0.2</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>p1=0.9</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> p<span class="sc">*</span>N1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>N2</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a><span class="fu">hist</span>(X,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">freq =</span> F,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fu">frac</span>(<span class="fl">0.9</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">frac</span>(<span class="fl">0.1</span>,<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span>e<span class="sc">^</span>(<span class="sc">-</span>(x<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(X))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA0lBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmZpBmkJBmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQZmaQZpCQkGaQkJCQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2Zma2kDq2kGa2kJC2kLa227a22/+2/7a2///T09PbkDrbkGbbtmbbtpDb/7bb////tmb/tpD/25D/27b//7b//9v///+jmZvrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM/0lEQVR4nO2da4OjthWG5c3OeJuk6TjNrd1mnTZpm6TD5NJOa3ox8dr8/79UhCSQAOlI6IJgz/thZuwBncPD0V0IUqOMIks7kLsQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAQoO6PbTnuxen/vPXxOy+zK0lWlbja6HN2FtBAdUEKp78fF6UD/HtEXNfUIyB1SRl8/1297Ngtw917en0G5P2qrr/+5J7oCK3WPz87Lnt/V6uKM54HaMEUIDW/XtK/LyL5kDuh05kDtWMlwPzPvi7mw4K4yt+vrx63OVOaAOyIt/8c/8IvjnkH4NbbUKDIjEBtSUQR+daRlkA+h2JEREw4KAVDdiA7rsaUWze38C0O3vg2xXNecWb7hj3VF/1WVOJ0CKsZFlxZbqRmxA9dtPCfnguRgDun47lUA5BFTfvtEEnwsgxdi0ZcVWGQvQqOBUvla++uPUdVe8RqJuXXidff1cc7+nbE0DUoxNWa6aKH/sbUluRK7m+e2tyMPIpamKvxBfEtYmrtrUCk2xMrTVJjsJSDE2Yfny6rGuWk9bW7IbsRuKJbk/N+239lJk3Y7jC+m/o15VTWCwbypNG2HcUNQAUoxNWaa6fvzIbKluROxqlJQK72qMAoi5w0WPvOwfiu5I4RXrWV1+pSmFBraoJgEpxtgHblI6qGxvQ2NLdSN8Z/VH0YFkTtPO6nvjzioN6l5NTBeys8Ir7vSrYfxpbNUaQEoC/MPA5IUHuXKoNaDbz3/r/v7l9XS8O6pSMt3t+IWSjbhXJaufLnvPto1ijH8YmuRlkGLLFtDbz56lT5fPHBvFk2rvFG2SsTyi3njBh1+XNoJmGROpUZO9AyLrybaI5Mukrp+09ez1U9U/bZHgIqVYaD59JyfKnCq7xqavwYkyaGiyAyR9CQIq2sbB7TgsYcsAPc9BxfKgJNo61d9LXS0219ibkUmavS4fnge2IEC8h1mOqmi19J8puTVC+/qiXdw5xaooejFP3t2rcTtoYLIkvLf4NCiCzIAoTd4fV//h2jef0g/aNAY+6VrSs43pLSu2yJQzkipWfFWsCGO/ClaWFrO7zG/pCDWrB6+/0133wKef594NnTG9ZcWWJaCCN/IoFA6LNo/nucz69vxsXZ9a9Uk5qnLJ23pj2t688j0EiGWxpiJk0XI9vPjHgWetiswsNgvym7PPCLUTIF9jTBCgpqvADZTkffFnxUs0Vo6Ku0RgsX7l/BHqHlACY9yQ/l8DQE0sCVOV1QDhWDzoydwAdIogb2NM9oCavwQWb0BzTu/C1fJkL2O9rMugxsEvRAiJMkjNYjY+ezag3CIoQGvNoh0karGqrdEYLKAW05YKt+PuD02S/9n7l0EJjPH09f9igHjVfqU12GXPIqc01wz6NHnYj9rmtpoCFM0YlL7akmbBU7bhBLWkDWnSthv59bP+ALOcAPkaA9Pncu+LpVxSE90WbGDckAB680mXHGUAaDwe9IG53nznANW3r2RC6viiLkk6X7j7KPyKheTG7Makf5LGpL+FHBGTfo1ehhidXdZYhBAlbbfky+bGHsfTPeFtRTYWBxAfq5NHCeOI1LGNhQckpZgGUFxjYQENJpLaKfknEqJBO20rgbGQgBrPlBTbnklF4gAa2IpmLCAg7nGXIpvNffr+9uezOgsWyBhRb0YkY4HLIMnpkq69oLp+fr7+NkIVLAOKZywWoKbuFR2Sy4fnIJOxWltRjYWuxUjHp2uVVPdhZqvHtuoExiIBkmbO6CTv5dXjv0OXQp2tuMaCt4PYvLo0HkxH16Tx7OC2IhuLA0hUt63PtI/0tIvxsAZzPq6xpGMTaxQCAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICNAcQN5P36xJLoD4w3EBFv6tSE4RxB89xQjSii03Q0AGFe2znghIr5I8xADUFmzBUw0gd6cu+/diADqdThsBJK0tD+nHhgBF0dYAlaHbQVsDNEyl0+wUtg3IPzkEBJ24DUB8pwJ9T+wdB1SKZSYT+wHNSE45cQuApD0YdI9rzLtGGpRbACTtk1ppMtlMQA2cLQCKF0EbAdQ/aRi4DNoMoG5MUfvA2LsOKFJyCAg6CwEBZyEg4CwEBJyFgICzGjhNWxoBac9qAW1l0D5Cck3wYBYznsU7qzkSygQQK6RzJJQVoDpDQp1HTTcrwFPDvtV8xoDa3Si9n833bgdlR0h1yJvRrOsjckMxN0JDf0q/xVEBAGVGSHGHPpr2ZuoVBmAqXhOHCqDc1nn0rtDBMEZGN+DslJzLOVIh3SqnJqNUi4XYrsAbEP2VVYuxB8T3K/AIn9oXEG9Qs788vAipESC/dRszLov01Xz/K59cxv0o+mI2dTU/CSifXDaKoEDJOZ0yCSiTbLZsX4xTmACUzRDjwoDYGEf+gK6Hh+45g5SFtAkQyQnQUsnRYQ4EZDp8TYCabEa7qtE2OJ88nJy0gE55tIV6H4q7M33ZW+E1bLZhQO0b8+i7M0yFdEn4q4J17W33QnpVgOgLCU1dDbq1NNvPMSQgQqYB5dGalrLYPX0azLSfJVth1g4XhQFEiNrsyRtQ0xDaPRpf0yHWKDal1bsICFa3RrG4DwKIAIDyKoNsJLDot1GzTY73RSFAGfRXewfAVfR1v4pT+14Ea0BsphkEtHwQSYV0iCec3ACBWSwnQLQhHTA56LhJHpkDcnnO0reQFp2tFQHyeg+X87yYJaAMavreAd2r7GcmBxzXdiVWBSjtgNkKAVkp2AN1hNgByqgMslG4B+rIEMsaADWZ7O5cGCr7gI9DWVbzWQGqdo8l7c3rCQV8oM4e0NKEpGqevR3aMB60SARlA4iGB71s04hisAfqyAoBiQgqTKP2oR6ocwC09Jq8YRkEvN/RPjnzYWsExMIj3jslpYPIOgElS06sG7es5pclhIAgZ8UfrPz1m1e1BWTgMQVoUULCOH+7Sem51j4GoGVDiBuvROHsucNdHEBLEmK2pdGy+HPzuolULaBFCXULqMQXsVe56mea9YBqp9HKsBKAwG6oS3LGI4iRx3QWW/CJzVUAOi24nGotgE5LTXCkB2TmoQW0VL9eAOonbnIFtGgEJUzOFZBU6y0SQ2Fs2k8cjkbrIUDSr0XaQ6kjyAtQvUBrKDEg4pzFBoCSl0QrA5S+LksLiLgX0tIvskRzcU2AToPmUJISKSkgqdXnAajDkiSeUgIifaPGA9Bpy4AceOgBddlsa4DgRa3WgOruSc6w7jteUdjkLFb92gPi+TXBSupkgIjFql/7LEb6gbSNACK1Iw8joFM/kLb2COLPfQ9Hov0BiRTzAuS+RpGwItWdBwRIbhjNuXBbOSU+Y40iv9kxAcUdBXFJe84Ks9k8HABFJeSS9Jw1iuTkNg02C1AdMZtFjyDHSYxZZZAYzOwHNsPxciyDXNcozu962QMS9X5P5xSwceSWkuMaReIxPuYMqO8IsxAKFEjR2kEi6pMBGrW1wwRSVED1coBY9RAghGamYH6gTrp/C0aQCCTFP2dmoefFVqO0gDYsBAQocGd1ewrcWd2eAnc1TJZykaPbDsf6LbOyWBmTyRGzD/eMoNUcMf9wuLPqZSmXIzwOBzurXpZyOcLncA/lcvkIyPsIn8M9lMvlIyDvI3wO91Aul58toJUKAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQoGaB2ztEwkl1Bu19BCTAZt2Cje7cQx/ftpgJ0OzaXX+qdo9vPVCZCUAI8GfNwedX81/TehwmlAsS23dHunMJmlEw7zwAJMLWbier/zay4bd+StgzSxojV5ZsSYCrv/mQCdHnlvoVdWkDaffOZ6/B8rXnj/SYVYxlUvfjnwfUljkkB6ecbWWQA8QFNWNIcZARU0mUpjluvpwRUmctoGJAhASpwI9FyZxenshICMt1+qywGTHi3aZgBtem7bdOWABB/R7txgz2bQhraoa/ky1v0l89ugFtRnSyCzJvEwtU8kIAQsFcvTSLPLHbZm28/2FCEEuAyt6RpKSUt4rFRKkA8/vUISqCrASbABHQ1KpvuiiLsrAJCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQEKC8AV32bKrd8/3BPsobEF8zZbmyI4oyB9Su2nRcVRhWuQOiy7793kvpqdwBNdnr936vfvVU9oC8Xx7sqewB3Y7L7rmXPaDi7n9uT58EVu6AqqYFtOimhJkDuuxp9BTQ0s2IyhvQ7diWP9fDnE3TwihrQE0BzWp44CGNmMoaUA5CQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBATo/zAZ1ApXBGJJAAAAAElFTkSuQmCC" /><!-- --></p>
<p>通过观察上面9幅直方图，可以直观地发现p1的取值在[0.3,0.7]之间时，双峰分布明显。当p1&lt;0.3或p1&gt;0.7时，双峰不明显。</p>
</div>
<div id="exercise-3.20" class="section level2">
<h2>Exercise 3.20</h2>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>A compound Poisson process is a stochastic process {<span class="math inline">\(X(t),t\ge0\)</span>} that can be represented as
the random sum <span class="math inline">\(X(t)=\begin{matrix}
\sum_{i=1}^{N(t)} Y_i \end{matrix},t\ge0\)</span>, where {<span class="math inline">\(N(t),t\ge0\)</span>} is a Poisson process and
<span class="math inline">\(Y_1\)</span>, <span class="math inline">\(Y_2\)</span>,… are iid and independent of {<span class="math inline">\(N(t),t\ge0\)</span>}. Write a program to simulate
a compound Poisson(λ)–Gamma process (Y has a Gamma distribution).
Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the
parameters and compare with the theoretical values. Hint: Show that
<span class="math inline">\(E[X(t)]=\lambda tE[Y_1]\)</span> and <span class="math inline">\(Var(X(t))=\lambda tE[Y_1^2]\)</span>.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>基本思路：{<span class="math inline">\(N(t),t\ge0\)</span>}是一个泊松过程，在实际中常被使用的计数随机过程，它表示到时刻t为止，已发生的事件<span class="math inline">\(Y_i\)</span>的总数，该总数服从泊松分布。而<span class="math inline">\(Y_i\)</span>是一独立同分布的随机变量，且与{<span class="math inline">\(N(t),t\ge0\)</span>}独立，本题中是Gamma分布。而{<span class="math inline">\(X(t),t\ge0\)</span>}就是这些独立同分布的随机变量的和。由此，模拟步骤如下：<br />
先生成1000个服从参数为<span class="math inline">\(\lambda
t\)</span>的泊松分布的随机变量，这些变量即为<span class="math inline">\(N(t)\)</span>;<br />
然后根据<span class="math inline">\(N(t)\)</span>的值，确定<span class="math inline">\(Y_i\)</span>的生成数量，<span class="math inline">\(Y_i\)</span>是服从参数已定的Gamma分布的随机变量;<br />
最后分别将不同<span class="math inline">\(N(t)\)</span>下的<span class="math inline">\(Y_i\)</span>累加，得到<span class="math inline">\(X(t)\)</span>。求出其均值和方差，与理论值比较。<br />
实现代码如下：</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">1</span>            <span class="co"># λ=1</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1000</span>,t<span class="sc">*</span>l)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n[i],<span class="at">shape =</span> <span class="dv">1</span>,<span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>}</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>x_mean_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)   <span class="co"># 均值的估计值</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>x_var_estimate <span class="ot">&lt;-</span> <span class="fu">var</span>(x)     <span class="co"># 方差的估计值</span></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>x_mean_theoretical <span class="ot">&lt;-</span> l<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(y)    <span class="co"># 均值的理论值</span></span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>x_var_theoretical <span class="ot">&lt;-</span> l<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(y<span class="sc">^</span><span class="dv">2</span>)   <span class="co"># 方差的理论值</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_mean_estimate: %f&quot;</span>,x_mean_estimate)</span></code></pre></div>
<pre><code>## [1] &quot;x_mean_estimate: 9.905867&quot;</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_mean_theoretical: %f&quot;</span>,x_mean_theoretical)</span></code></pre></div>
<pre><code>## [1] &quot;x_mean_theoretical: 10.215967&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_var_estimate: %f&quot;</span>,x_var_estimate)</span></code></pre></div>
<pre><code>## [1] &quot;x_var_estimate: 20.500565&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_var_theoretical: %f&quot;</span>,x_var_theoretical)</span></code></pre></div>
<pre><code>## [1] &quot;x_var_theoretical: 20.478460&quot;</code></pre>
<p>改变参数<span class="math inline">\(\lambda\)</span>的值，再求均值和方差，与理论值比较。<br />
<span class="math inline">\(\lambda=5\)</span></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">5</span>            <span class="co"># λ=5</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1000</span>,t<span class="sc">*</span>l)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n[i],<span class="at">shape =</span> <span class="dv">1</span>,<span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>}</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>x_mean_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)   <span class="co"># 均值的估计值</span></span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>x_var_estimate <span class="ot">&lt;-</span> <span class="fu">var</span>(x)     <span class="co"># 方差的估计值</span></span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>x_mean_theoretical <span class="ot">&lt;-</span> l<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(y)    <span class="co"># 均值的理论值</span></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>x_var_theoretical <span class="ot">&lt;-</span> l<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(y<span class="sc">^</span><span class="dv">2</span>)   <span class="co"># 方差的理论值</span></span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_mean_estimate: %f&quot;</span>,x_mean_estimate)</span></code></pre></div>
<pre><code>## [1] &quot;x_mean_estimate: 50.008075&quot;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_mean_theoretical: %f&quot;</span>,x_mean_theoretical)</span></code></pre></div>
<pre><code>## [1] &quot;x_mean_theoretical: 50.686364&quot;</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_var_estimate: %f&quot;</span>,x_var_estimate)</span></code></pre></div>
<pre><code>## [1] &quot;x_var_estimate: 106.222487&quot;</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_var_theoretical: %f&quot;</span>,x_var_theoretical)</span></code></pre></div>
<pre><code>## [1] &quot;x_var_theoretical: 105.489724&quot;</code></pre>
<p><span class="math inline">\(\lambda=10\)</span></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="dv">10</span>            <span class="co"># λ=10</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1000</span>,t<span class="sc">*</span>l)</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="at">length =</span> <span class="dv">1000</span>)</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n[i],<span class="at">shape =</span> <span class="dv">1</span>,<span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(y)</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>}</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>x_mean_estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)   <span class="co"># 均值的估计值</span></span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>x_var_estimate <span class="ot">&lt;-</span> <span class="fu">var</span>(x)     <span class="co"># 方差的估计值</span></span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>x_mean_theoretical <span class="ot">&lt;-</span> l<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(y)    <span class="co"># 均值的理论值</span></span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>x_var_theoretical <span class="ot">&lt;-</span> l<span class="sc">*</span>t<span class="sc">*</span><span class="fu">mean</span>(y<span class="sc">^</span><span class="dv">2</span>)   <span class="co"># 方差的理论值</span></span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_mean_estimate: %f&quot;</span>,x_mean_estimate)</span></code></pre></div>
<pre><code>## [1] &quot;x_mean_estimate: 99.964501&quot;</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_mean_theoretical: %f&quot;</span>,x_mean_theoretical)</span></code></pre></div>
<pre><code>## [1] &quot;x_mean_theoretical: 102.721453&quot;</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_var_estimate: %f&quot;</span>,x_var_estimate)</span></code></pre></div>
<pre><code>## [1] &quot;x_var_estimate: 208.072615&quot;</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">&quot;x_var_theoretical: %f&quot;</span>,x_var_theoretical)</span></code></pre></div>
<pre><code>## [1] &quot;x_var_theoretical: 207.040626&quot;</code></pre>
<p>结论：经过不同参数的比较，可以发现均值和方差的估计值与公式求的理论值非常接近。</p>
</div>
<div id="exercise-5.4" class="section level2">
<h2>Exercise 5.4</h2>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3,3)
cdf, and use the function to estimate F(x) forx=0.1,0.2,…,0.9. Compare
the estimates with the values returned by the pbeta function in R.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>利用Monte Carlo方法估计Beta(3,3)的累积分布函数思路如下： <span class="math display">\[\theta=\int_{0}^{x}\frac{1}{B(\alpha,\beta)}y^{\alpha-1}(1-y)^{\beta-1}\mathrm{d}y=E_Y[x\frac{1}{B(\alpha,\beta)}Y^{\alpha-1}(1-Y)^{\beta-1}],\qquad
Y\sim U(0,x)\]</span> 由Monte Carlo方法得： <span class="math display">\[\hat{\theta}=\frac{1}{m}x\sum_{i=1}^m
\frac{1}{B(\alpha,\beta)}y^{\alpha-1}(1-y)^{\beta-1}\]</span>
实现代码如下：</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>MyFun <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>{</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,x)</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>  F_est <span class="ot">&lt;-</span> x<span class="sc">*</span><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">beta</span>(a,b)<span class="sc">*</span>y<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>(b<span class="dv">-1</span>))</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>  <span class="fu">return</span>(F_est)</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>}</span></code></pre></div>
<p>然后使x=0.1,0.2,…,0.9，分别求出估计值与pbeta函数算出的值进行比较：</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>F_estimate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>F_pbeta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>  F_estimate[i] <span class="ot">&lt;-</span> <span class="fu">MyFun</span>(x[i])  <span class="co"># 利用我们写的函数计算F(x)</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>  F_pbeta[i] <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x[i],<span class="dv">3</span>,<span class="dv">3</span>) <span class="co"># 利用r语言自带的pbeta函数计算F(x)</span></span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>}</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(x, F_estimate, F_pbeta), <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##             [,1]  [,2]  [,3]  [,4] [,5]  [,6]  [,7]  [,8]  [,9]
## x          0.100 0.200 0.300 0.400  0.5 0.600 0.700 0.800 0.900
## F_estimate 0.009 0.058 0.161 0.316  0.5 0.703 0.818 0.944 1.018
## F_pbeta    0.009 0.058 0.163 0.317  0.5 0.683 0.837 0.942 0.991</code></pre>
<p>结果分析：利用Monte
Carlo方法估计的F(x)值非常接近于pbeta函数计算的值。</p>
</div>
<div id="exercise-5.9" class="section level2">
<h2>Exercise 5.9</h2>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},\qquad
x\ge0,\,\sigma&gt;0.\]</span> Implement a function to generate samples
from a Rayleigh(σ) distribution, using antithetic variables. What is the
percent reduction in variance of <span class="math inline">\(\frac{x+x^\prime}{2}\)</span> compared with <span class="math inline">\(\frac{x_1+x_2}{2}\)</span> for independent <span class="math inline">\(X_1\)</span>,<span class="math inline">\(X_2\)</span>?</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>基本思路：根据之前课上学的生成随机数的方法——逆变换法，同时结合对偶变数法来生成Rayleigh分布的随机数，与不使用对偶变数法生成Rayleigh分布的随机数进行对比，比较两者的方差。<br />
实现代码如下：</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>MyFunRay <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">m=</span><span class="dv">1000</span>,<span class="at">antithetic=</span><span class="cn">TRUE</span>,<span class="at">sigma=</span><span class="dv">1</span>){  <span class="do">##默认10000个抽样，使用对偶变数法，参数sigma=1</span></span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>  <span class="cf">if</span>(antithetic)</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>a</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">c</span>(a,b)</span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>  Ray <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>n)))  <span class="do">##逆变换法生成随机数，并求均值(Monte Carlo)</span></span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>  <span class="fu">return</span>(Ray)</span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a>}</span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a>Ray1 <span class="ot">&lt;-</span> Ray2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(t)</span>
<span id="cb66-15"><a href="#cb66-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>t) {</span>
<span id="cb66-16"><a href="#cb66-16" tabindex="-1"></a>  Ray1[i] <span class="ot">&lt;-</span> <span class="fu">MyFunRay</span>(<span class="at">antithetic =</span> <span class="cn">FALSE</span>)  <span class="do">##不使用对偶变数法</span></span>
<span id="cb66-17"><a href="#cb66-17" tabindex="-1"></a>  Ray2[i] <span class="ot">&lt;-</span> <span class="fu">MyFunRay</span>()  <span class="do">##使用对偶变数法</span></span>
<span id="cb66-18"><a href="#cb66-18" tabindex="-1"></a>}</span>
<span id="cb66-19"><a href="#cb66-19" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">var</span>(Ray1),<span class="fu">var</span>(Ray2),(<span class="fu">var</span>(Ray1) <span class="sc">-</span> <span class="fu">var</span>(Ray2))<span class="sc">/</span><span class="fu">var</span>(Ray1)),<span class="dv">9</span>))</span></code></pre></div>
<pre><code>## [1] 0.000458482 0.000022432 0.951073392</code></pre>
<p>结果分析：利用对偶变数法可以减少方差，达到了约95%的减少度。</p>
</div>
<div id="exercise-5.13" class="section level2">
<h2>Exercise 5.13</h2>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on (1,<span class="math inline">\(\infty\)</span>)and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\qquad
x&gt;1.\]</span> Which of your two importance functions should produce
the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\mathrm{d}x\]</span>
by importance sampling? Explain.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>基本思路：根据重要性采样方法的原理，我找到的两个接近于g(x)的函数<span class="math inline">\(f_1\)</span>和<span class="math inline">\(f_2\)</span>如下： <span class="math display">\[f_1(x)=\frac{x^2}{\sqrt{2\pi}},\qquad
x&gt;1\]</span> <span class="math display">\[f_2(x)=xe^{-x^2/2},\qquad
x&gt;1\]</span> 实现代码如下：</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>va <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>}</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)  <span class="do">##f1函数</span></span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(f1)</span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(f1)</span>
<span id="cb68-18"><a href="#cb68-18" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb68-20"><a href="#cb68-20" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>(x<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))  <span class="do">##f2函数</span></span>
<span id="cb68-21"><a href="#cb68-21" tabindex="-1"></a>theta.hat[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(f2)</span>
<span id="cb68-22"><a href="#cb68-22" tabindex="-1"></a>se[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(f2)</span>
<span id="cb68-23"><a href="#cb68-23" tabindex="-1"></a></span>
<span id="cb68-24"><a href="#cb68-24" tabindex="-1"></a>va[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">abs</span>(fg<span class="sc">-</span>f1))  <span class="do">##f1产生的方差</span></span>
<span id="cb68-25"><a href="#cb68-25" tabindex="-1"></a>va[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">abs</span>(fg<span class="sc">-</span>f2))  <span class="do">##f2产生的方差</span></span>
<span id="cb68-26"><a href="#cb68-26" tabindex="-1"></a></span>
<span id="cb68-27"><a href="#cb68-27" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat,se)</span></code></pre></div>
<pre><code>##                [,1]     [,2]      [,3]
## theta.hat 0.1005450 4.124267 0.1533005
## se        0.1113611 2.804626 0.2002414</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">print</span>(va)</span></code></pre></div>
<pre><code>## [1] 7.8807638 0.0262196</code></pre>
<p>结果分析：根据上面代码的数据可以发现函数<span class="math inline">\(f_2\)</span>更接近于g(x)，在估计<span class="math inline">\(\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\mathrm{d}x\)</span>时，产生的方差更小。</p>
</div>
<div id="monte-carlo-experiment" class="section level2">
<h2>Monte Carlo experiment</h2>
<ul>
<li>For <span class="math inline">\(n=10^4,2\times10^4,4\times10^4,6\times10^4,8\times10^4\)</span>,
apply the fast sorting algorithm to randomly permuted numbers of <span class="math inline">\(1,\ldots,n\)</span>.</li>
<li>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</li>
</ul>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>    t[j] <span class="ot">&lt;&lt;-</span> t[j]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>    t[j] <span class="ot">&lt;&lt;-</span> t[j]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a>}</span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e4</span>,<span class="dv">2</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">4</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">6</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">8</span><span class="sc">*</span><span class="fl">1e4</span>)</span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb72-20"><a href="#cb72-20" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb72-21"><a href="#cb72-21" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n[i])</span>
<span id="cb72-22"><a href="#cb72-22" tabindex="-1"></a>    <span class="fu">quick_sort</span>(x)  <span class="do">## 快速排序算法</span></span>
<span id="cb72-23"><a href="#cb72-23" tabindex="-1"></a>  }</span>
<span id="cb72-24"><a href="#cb72-24" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(t)  <span class="do">## 100次模拟的平均时间</span></span>
<span id="cb72-25"><a href="#cb72-25" tabindex="-1"></a>}</span>
<span id="cb72-26"><a href="#cb72-26" tabindex="-1"></a>x <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">log2</span>(n)  <span class="do">## 期望时间，O(nlog2(n))</span></span>
<span id="cb72-27"><a href="#cb72-27" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb72-28"><a href="#cb72-28" tabindex="-1"></a></span>
<span id="cb72-29"><a href="#cb72-29" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Average Estimated Time &amp; Expected Time Regression&quot;</span>,<span class="fu">abline</span>(ans),<span class="at">cex =</span> <span class="fl">1.3</span>,<span class="at">pch =</span> <span class="dv">16</span>,<span class="at">ylab =</span> <span class="st">&quot;computation time averaged over 100 simulations&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;expected time t = nlog(n)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
结果分析：根据实验得出的散点图和回归线来看，快速排序算法模拟100次的平均时间与期望时间非常接近，进一步验证了快排算法的平均时间复杂度为O(nlog2(n))。</p>
</div>
<div id="exercise-6.6" class="section level2">
<h2>Exercise 6.6</h2>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality by a
Monte Carlo experiment. Compute the standard error of the estimates from
(2.14) using the normal approximation for the density (with exact
variance formula). Compare the estimated quantiles with the quantiles of
the large sample approximation <span class="math inline">\(\sqrt{b_1}\approx N(0,6/n)\)</span>.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>Estimate the 0.025 quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a>q.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="dv">0</span>,<span class="dv">6</span><span class="sc">/</span>n)</span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>  q.hat[i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x,<span class="fl">0.025</span>)  <span class="do">## Monte Carlo方法估算分位数</span></span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a>}</span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>,<span class="dv">0</span>,<span class="dv">6</span><span class="sc">/</span>n)  <span class="do">## 标准分位数</span></span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(q,<span class="fu">mean</span>(q.hat),<span class="fu">sd</span>(q.hat),<span class="fu">var</span>(q.hat)),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] -1.1760 -1.1756  0.0161  0.0003</code></pre>
<p>Estimate the 0.05 quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>q.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="dv">0</span>,<span class="dv">6</span><span class="sc">/</span>n)</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>  q.hat[i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x,<span class="fl">0.05</span>)  <span class="do">## Monte Carlo方法估算分位数</span></span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>}</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.05</span>,<span class="dv">0</span>,<span class="dv">6</span><span class="sc">/</span>n)  <span class="do">## 标准分位数</span></span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(q,<span class="fu">mean</span>(q.hat),<span class="fu">sd</span>(q.hat),<span class="fu">var</span>(q.hat)),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] -0.9869 -0.9867  0.0127  0.0002</code></pre>
<p>Estimate the 0.95 quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>q.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="dv">0</span>,<span class="dv">6</span><span class="sc">/</span>n)</span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>  q.hat[i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x,<span class="fl">0.95</span>)  <span class="do">## Monte Carlo方法估算分位数</span></span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>}</span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.95</span>,<span class="dv">0</span>,<span class="dv">6</span><span class="sc">/</span>n)  <span class="do">## 标准分位数</span></span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(q,<span class="fu">mean</span>(q.hat),<span class="fu">sd</span>(q.hat),<span class="fu">var</span>(q.hat)),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] 0.9869 0.9868 0.0127 0.0002</code></pre>
<p>Estimate the 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>q.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m,<span class="dv">0</span>,<span class="dv">6</span><span class="sc">/</span>n)</span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>  q.hat[i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x,<span class="fl">0.975</span>)  <span class="do">## Monte Carlo方法估算分位数</span></span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>}</span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="dv">6</span><span class="sc">/</span>n)  <span class="do">## 标准分位数</span></span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(q,<span class="fu">mean</span>(q.hat),<span class="fu">sd</span>(q.hat),<span class="fu">var</span>(q.hat)),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## [1] 1.1760 1.1757 0.0158 0.0003</code></pre>
<p>结果分析：使用Monte
Carlo方法估算的分位数与该分布下的标准分位数非常接近，估算的分位数标准误差在0.01量级上，方差在0.0001量级上。</p>
</div>
<div id="exercise-6.b" class="section level2">
<h2>Exercise 6.B</h2>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in cor.test. Show (empirically) that the nonparametric tests based on
<span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution (X,Y) such that X
and Y are dependent) such that at least one of the nonparametric tests
have better empirical power than the correlation test against this
alternative.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>nump <span class="ot">&lt;-</span> numk <span class="ot">&lt;-</span> nums <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> p3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a>  mean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">500</span>, mean, sigma)</span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data[, <span class="dv">2</span>] </span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a>  </span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a>  a1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span>  <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a>  a2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span>  <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a>  a3 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span>  <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a>  </span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a>  p1[i] <span class="ot">&lt;-</span> a1<span class="sc">$</span>p.value</span>
<span id="cb84-17"><a href="#cb84-17" tabindex="-1"></a>  p2[i] <span class="ot">&lt;-</span> a2<span class="sc">$</span>p.value</span>
<span id="cb84-18"><a href="#cb84-18" tabindex="-1"></a>  p3[i] <span class="ot">&lt;-</span> a3<span class="sc">$</span>p.value</span>
<span id="cb84-19"><a href="#cb84-19" tabindex="-1"></a>}</span>
<span id="cb84-20"><a href="#cb84-20" tabindex="-1"></a></span>
<span id="cb84-21"><a href="#cb84-21" tabindex="-1"></a>nump[p1 <span class="sc">&lt;</span> <span class="fl">0.05</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb84-22"><a href="#cb84-22" tabindex="-1"></a>numk[p2 <span class="sc">&lt;</span> <span class="fl">0.05</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb84-23"><a href="#cb84-23" tabindex="-1"></a>nums[p3 <span class="sc">&lt;</span> <span class="fl">0.05</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb84-24"><a href="#cb84-24" tabindex="-1"></a></span>
<span id="cb84-25"><a href="#cb84-25" tabindex="-1"></a>ratio <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>(nump), <span class="fu">sum</span>(numk), <span class="fu">sum</span>(nums)) <span class="sc">/</span> m</span>
<span id="cb84-26"><a href="#cb84-26" tabindex="-1"></a><span class="fu">print</span>(ratio)</span></code></pre></div>
<pre><code>## [1] 0.935 0.903 0.901</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">barplot</span>(ratio,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>,<span class="st">&quot;kendall&quot;</span>,<span class="st">&quot;spearman&quot;</span>),<span class="at">main =</span> <span class="st">&quot;Power of a Test&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
结果分析：由实验结果可知，pearson的检验功效比kendall和spearman都大，这验证了题目中的这个判断：nonparametric
tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>nump <span class="ot">&lt;-</span> numk <span class="ot">&lt;-</span> nums <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="ot">&lt;-</span> p3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>  mean <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n , mean, sigma)</span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data[, <span class="dv">1</span>]</span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data[, <span class="dv">2</span>] <span class="sc">+</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a>  </span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a>  a1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span>  <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb87-15"><a href="#cb87-15" tabindex="-1"></a>  a2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span>  <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb87-16"><a href="#cb87-16" tabindex="-1"></a>  a3 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span>  <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb87-17"><a href="#cb87-17" tabindex="-1"></a>  </span>
<span id="cb87-18"><a href="#cb87-18" tabindex="-1"></a>  p1[i] <span class="ot">&lt;-</span> a1<span class="sc">$</span>p.value</span>
<span id="cb87-19"><a href="#cb87-19" tabindex="-1"></a>  p2[i] <span class="ot">&lt;-</span> a2<span class="sc">$</span>p.value</span>
<span id="cb87-20"><a href="#cb87-20" tabindex="-1"></a>  p3[i] <span class="ot">&lt;-</span> a3<span class="sc">$</span>p.value</span>
<span id="cb87-21"><a href="#cb87-21" tabindex="-1"></a>}</span>
<span id="cb87-22"><a href="#cb87-22" tabindex="-1"></a></span>
<span id="cb87-23"><a href="#cb87-23" tabindex="-1"></a>nump[p1 <span class="sc">&lt;</span> <span class="fl">0.05</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb87-24"><a href="#cb87-24" tabindex="-1"></a>numk[p2 <span class="sc">&lt;</span> <span class="fl">0.05</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb87-25"><a href="#cb87-25" tabindex="-1"></a>nums[p3 <span class="sc">&lt;</span> <span class="fl">0.05</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb87-26"><a href="#cb87-26" tabindex="-1"></a></span>
<span id="cb87-27"><a href="#cb87-27" tabindex="-1"></a>ratio <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>(nump), <span class="fu">sum</span>(numk), <span class="fu">sum</span>(nums)) <span class="sc">/</span> m</span>
<span id="cb87-28"><a href="#cb87-28" tabindex="-1"></a><span class="fu">print</span>(ratio)</span></code></pre></div>
<pre><code>## [1] 0.048 0.049 0.049</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">barplot</span>(ratio,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;blue&quot;</span>),<span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>,<span class="st">&quot;kendall&quot;</span>,<span class="st">&quot;spearman&quot;</span>),<span class="at">main =</span> <span class="st">&quot;Power of a Test&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
结果分析：由实验结果可知，这次的kendall和spearman的检验功效比pearson的大，说明找到的二元分布(X,Y)符合题目的条件。</p>
</div>
<div id="question-11" class="section level2">
<h2>Question</h2>
<ul>
<li><p>Discussion</p>
<ul>
<li><p>If we obtain the powers for two methods under a particular
simulation setting with 10,000 experiments: say, 0.651 for one method
and 0.676 for another method. Can we say the powers are different at
0.05 level?</p>
<ul>
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>Which test can we use? Z-test, two-sample t-test, paired-t test
or McNemar test? Why?</p></li>
<li><p>Please provide the least necessary information for hypothesis
testing.</p></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>对应的假设检验问题是这两个power是否不同，也就是<span class="math inline">\(H_0:power_1=power_2\)</span>,<span class="math inline">\(H_1:power_1\neq power_2\)</span>。<br />
可以用Z-test，因为Z检验适用于总体呈正态分布，总体方差已知（或者方差未知，但样本容量够大），样本容量较大（≥30）的情况。题目条件属于方差未知，但样本容量够大，所以z的统计量为
<span class="math display">\[z=\frac{\bar{X}-\mu_0}{S/\sqrt{n}}\]</span><br />
实现代码如下：</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>U <span class="ot">&lt;-</span> (<span class="fl">0.651-0.676</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fl">0.651</span><span class="sc">*</span>(<span class="dv">1</span><span class="fl">-0.651</span>))<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">10000</span>)</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">abs</span>(U)</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">pnorm</span>(U, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>))  <span class="do">## 检验的p值</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>结果分析：检验的p值大于显著性水平0.05，所以接受原假设<span class="math inline">\(H_0:power_1=power_2\)</span>。即两个power在0.05显著性水平上相同。</p>
<ul>
<li><p>Class work</p>
<ul>
<li>Use the bootstrap method (R = 10000) to calculate the sample mean
difference for comparing the following two independent samples:</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, </span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>        <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>);</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>d2  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>,  <span class="fl">0.878</span>,  <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>,  </span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>         <span class="fl">0.680</span>, <span class="fl">2.280</span>,  <span class="fl">2.390</span>, <span class="fl">1.793</span>, <span class="fl">1.468</span>)</span></code></pre></div>
<ul>
<li>The outputs should include original statistic, sample standard
error, and bootstrap standard error.</li>
</ul></li>
</ul>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.961</span>, <span class="fl">0.478</span>, <span class="sc">-</span><span class="fl">0.391</span>, <span class="sc">-</span><span class="fl">0.869</span>, <span class="sc">-</span><span class="fl">0.460</span>, </span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>        <span class="sc">-</span><span class="fl">0.937</span>, <span class="fl">0.779</span>, <span class="sc">-</span><span class="fl">1.409</span>, <span class="fl">0.027</span>, <span class="sc">-</span><span class="fl">1.569</span>);</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>d2  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.608</span>, <span class="fl">1.009</span>,  <span class="fl">0.878</span>,  <span class="fl">1.600</span>, <span class="sc">-</span><span class="fl">0.263</span>,  </span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>         <span class="fl">0.680</span>, <span class="fl">2.280</span>,  <span class="fl">2.390</span>, <span class="fl">1.793</span>, <span class="fl">1.468</span>);</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>); B <span class="ot">&lt;-</span> <span class="fl">1e4</span>; thetastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(d1)<span class="sc">-</span><span class="fu">mean</span>(d2);</span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>  d1star <span class="ot">&lt;-</span> <span class="fu">sample</span>(d1,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a>  d2star <span class="ot">&lt;-</span> <span class="fu">sample</span>(d2,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a>  thetastar[b] <span class="ot">&lt;-</span> <span class="fu">mean</span>(d1star)<span class="sc">-</span><span class="fu">mean</span>(d2star)</span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a>}</span>
<span id="cb93-12"><a href="#cb93-12" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta,<span class="at">bias=</span><span class="fu">mean</span>(thetastar)<span class="sc">-</span>theta,<span class="at">se.boot=</span><span class="fu">sd</span>(thetastar),<span class="at">se.samp=</span><span class="fu">sd</span>(d1<span class="sc">-</span>d2)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(d2))),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## original     bias  se.boot  se.samp 
##   -2.075   -0.001    0.409    0.441</code></pre>
</div>
<div id="question-12" class="section level2">
<h2>Question</h2>
<p>Of N =1000 hypotheses, 950 are null and 50 are alternative. The
p-value under any null hypothesis is uniformly distributed (use runif),
and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1 (use rbeta). Obtain Bonferroni
adjusted p-values and B-H adjusted p-values. Calculate FWER, FDR, and
TPR under nominal level α =0.1 for each of the two adjustment methods
based on m=10000 simulation replicates. You should output the 6 numbers
(3) to a 3×2 table (column names: Bonferroni correction, B-H correction;
row names: FWER, FDR, TPR). Comment the results.</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">950</span>)</span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(p,<span class="fu">rbeta</span>(<span class="dv">50</span>,<span class="fl">0.1</span>,<span class="dv">1</span>))</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>  p.adj1 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)  <span class="co"># Bonferroni adjusted p-values</span></span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>  p.adj2 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)          <span class="co"># B-H adjusted p-values</span></span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a>  reject_null1 <span class="ot">&lt;-</span> p.adj1 <span class="sc">&lt;</span> a</span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>  reject_null2 <span class="ot">&lt;-</span> p.adj2 <span class="sc">&lt;</span> a</span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>  FWER1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_null1[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>])           <span class="co"># Bonferroni校正的FWER</span></span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a>  FWER2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_null2[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>])           <span class="co"># B-H校正的FWER</span></span>
<span id="cb95-15"><a href="#cb95-15" tabindex="-1"></a>  FDR1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_null1)                   <span class="co"># Bonferroni校正的FDR</span></span>
<span id="cb95-16"><a href="#cb95-16" tabindex="-1"></a>  FDR2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_null2)                   <span class="co"># B-H校正的FDR</span></span>
<span id="cb95-17"><a href="#cb95-17" tabindex="-1"></a>  TPR1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_null1[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>])         <span class="co"># Bonferroni校正的TPR</span></span>
<span id="cb95-18"><a href="#cb95-18" tabindex="-1"></a>  TPR2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_null2[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>])         <span class="co"># B-H校正的TPR</span></span>
<span id="cb95-19"><a href="#cb95-19" tabindex="-1"></a>  results[,<span class="dv">1</span>] <span class="ot">&lt;-</span> results[,<span class="dv">1</span>]<span class="sc">+</span><span class="fu">c</span>(FWER1, FDR1, TPR1)</span>
<span id="cb95-20"><a href="#cb95-20" tabindex="-1"></a>  results[,<span class="dv">2</span>] <span class="ot">&lt;-</span> results[,<span class="dv">2</span>]<span class="sc">+</span><span class="fu">c</span>(FWER2, FDR2, TPR2)</span>
<span id="cb95-21"><a href="#cb95-21" tabindex="-1"></a>}</span>
<span id="cb95-22"><a href="#cb95-22" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">/</span> m   <span class="co"># 取模拟的均值</span></span>
<span id="cb95-23"><a href="#cb95-23" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni correction&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>)</span>
<span id="cb95-24"><a href="#cb95-24" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb95-25"><a href="#cb95-25" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##      Bonferroni correction B-H correction
## FWER              0.000103        0.00323
## FDR               0.019956        0.03113
## TPR               0.397162        0.56111</code></pre>
<p>分析：Bonferroni校正的FWER较低，但TPR也较低，而B-H校正的FDR和TPR较高。因为Bonferroni检验过于严格，抹杀了一切假阳性的概率，但真阳性的概率也会受到影响而降低。而B-H是相对比较温和的方法校正P值，其试图在假阳性和假阴性间达到平衡，将假/真阳性比例控制到一定范围之内，所以会出现上述情况。</p>
</div>
<div id="exercise-7.4" class="section level2">
<h2>Exercise 7.4</h2>
</div>
<div id="question-13" class="section level2">
<h2>Question</h2>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
airconditioning equipment [63, Example 1.1]: <span class="math display">\[3, 5,7,18,43,85,91,98,100,130,230,487.\]</span>
Assume that the times between failures follow an exponential model
Exp(λ). Obtain the MLE of the hazard rate λ and use bootstrap to
estimate the bias and standard error of the estimate.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<p>思路：首先利用样本算出<span class="math inline">\(\lambda\)</span>，因为样本服从参数为<span class="math inline">\(\lambda\)</span>的指数分布，该期望为<span class="math inline">\(\frac{1}{\lambda}\)</span>，所以算出样本均值即可求出参数<span class="math inline">\(\lambda\)</span>。然后利用bootstrap算法求出<span class="math inline">\(\lambda^*\)</span>，再算bias和standard error of
the estimate。具体实现代码如下：</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a><span class="fu">t</span>(aircondit)</span></code></pre></div>
<pre><code>##       1 2 3  4  5  6  7  8   9  10  11  12
## hours 3 5 7 18 43 85 91 98 100 130 230 487</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)   <span class="co"># E(x)=1/λ</span></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>thetastar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>  hstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>  thetastar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(hstar)</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>}</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">MLE=</span>theta),<span class="dv">8</span>)</span></code></pre></div>
<pre><code>##     MLE 
## 0.00925</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias=</span><span class="fu">mean</span>(thetastar)<span class="sc">-</span>theta,<span class="at">se.boot=</span><span class="fu">sd</span>(thetastar)),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##    bias se.boot 
##   0.001   0.004</code></pre>
</div>
<div id="exercise-7.5" class="section level2">
<h2>Exercise 7.5</h2>
</div>
<div id="question-14" class="section level2">
<h2>Question</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<p>思路：大致过程与上题相似，只是改成使用r语言自带的boot函数和boot.ci函数来实现bootstrap算法和求置信区间。具体代码如下：</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a><span class="fu">t</span>(aircondit)</span></code></pre></div>
<pre><code>##       1 2 3  4  5  6  7  8   9  10  11  12
## hours 3 5 7 18 43 85 91 98 100 130 230 487</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span>;r <span class="ot">&lt;-</span> <span class="fl">1e3</span>;</span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> r)</span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a><span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = de, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.3, 182.0 )   ( 25.8, 169.2 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.9, 190.4 )   ( 56.9, 231.8 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>解释为什么这4种方法得出的区间不一样：<br />
使用norm方法：我们认为<span class="math inline">\(\hat{\theta}\)</span>服从正态分布并且样本规模足够大，但是题目中样本规模很小。<br />
使用basic方法：基本的bootstrap置信区间通过减去观察到的统计量来变换复制样本的分布。<br />
使用perc方法：经验分布的分位数是<span class="math inline">\(\hat{\theta}\)</span>抽样分布的分位数的估计量，当<span class="math inline">\(\hat{\theta}\)</span>的分布不呈正态分布时，这些随机的分位数就能更接近真实的分布。<br />
使用bca方法：更好的置信区间是百分位区间的一种改进版本，具有更好的理论性质和更佳的实际表现。</p>
</div>
<div id="question-15" class="section level2">
<h2>Question</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<p>思路：先按照题目要求计算出所求参数<span class="math inline">\(\theta\)</span>，然后利用jackknife方法求参数估计值<span class="math inline">\(\hat{\theta}\)</span>，最后根据上课所学公式求出jackknife
estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>。</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)  <span class="do">## 5X5的协方差矩阵</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma)  <span class="do">## 求特征值</span></span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">sort</span>(s<span class="sc">$</span>values, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)  <span class="do">## 按特征值降序排列</span></span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>theta <span class="ot">&lt;-</span> lambda[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda)  <span class="do">## 求参数theta</span></span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a><span class="do">## 利用jackknife方法求参数的估计值theta.jack</span></span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a>theta.jack<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb107-10"><a href="#cb107-10" tabindex="-1"></a>  sigma.jack <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor[<span class="sc">-</span>i,])</span>
<span id="cb107-11"><a href="#cb107-11" tabindex="-1"></a>  s.jack <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.jack)</span>
<span id="cb107-12"><a href="#cb107-12" tabindex="-1"></a>  lambda.jack <span class="ot">&lt;-</span> <span class="fu">sort</span>(s.jack<span class="sc">$</span>values, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-13"><a href="#cb107-13" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> lambda.jack[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.jack)</span>
<span id="cb107-14"><a href="#cb107-14" tabindex="-1"></a>}</span>
<span id="cb107-15"><a href="#cb107-15" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta)  <span class="do">## jackknife estimates of bias</span></span>
<span id="cb107-16"><a href="#cb107-16" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta)<span class="sc">^</span><span class="dv">2</span>))  <span class="do">## jackknife estimates of se</span></span>
<span id="cb107-17"><a href="#cb107-17" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
<p>根据代码结果显示，利用jackknife方法得出的参数估计值非常接近参数原始值，bias非常小。</p>
</div>
<div id="question-16" class="section level2">
<h2>Question</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<p>思路：求解过程和例题相同，只需将Log-Log model换成cubic polynomial
model，然后计算4种模型的average squared prediction error和adjusted <span class="math inline">\(R^{2}\)</span>，以此来选择模型。</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>ssr1 <span class="ot">&lt;-</span> ssr2 <span class="ot">&lt;-</span> ssr3 <span class="ot">&lt;-</span> ssr4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>sst1 <span class="ot">&lt;-</span> sst2 <span class="ot">&lt;-</span> sst3 <span class="ot">&lt;-</span> sst4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a>ymean <span class="ot">&lt;-</span> <span class="fu">mean</span>(magnetic)</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a>  <span class="co"># Linear model</span></span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb112-12"><a href="#cb112-12" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb112-13"><a href="#cb112-13" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb112-14"><a href="#cb112-14" tabindex="-1"></a>  ssr1[k] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb112-15"><a href="#cb112-15" tabindex="-1"></a>  sst1[k] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> ymean)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb112-16"><a href="#cb112-16" tabindex="-1"></a>  <span class="co"># Quadratic model</span></span>
<span id="cb112-17"><a href="#cb112-17" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb112-18"><a href="#cb112-18" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb112-19"><a href="#cb112-19" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb112-20"><a href="#cb112-20" tabindex="-1"></a>  ssr2[k] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb112-21"><a href="#cb112-21" tabindex="-1"></a>  sst2[k] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> ymean)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb112-22"><a href="#cb112-22" tabindex="-1"></a>  <span class="co"># Exponential model</span></span>
<span id="cb112-23"><a href="#cb112-23" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb112-24"><a href="#cb112-24" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb112-25"><a href="#cb112-25" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb112-26"><a href="#cb112-26" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb112-27"><a href="#cb112-27" tabindex="-1"></a>  ssr3[k] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb112-28"><a href="#cb112-28" tabindex="-1"></a>  sst3[k] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> ymean)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb112-29"><a href="#cb112-29" tabindex="-1"></a>  <span class="co"># Cubic polynomial model</span></span>
<span id="cb112-30"><a href="#cb112-30" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb112-31"><a href="#cb112-31" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb112-32"><a href="#cb112-32" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> magnetic[k]<span class="sc">-</span> yhat4</span>
<span id="cb112-33"><a href="#cb112-33" tabindex="-1"></a>  ssr4[k] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb112-34"><a href="#cb112-34" tabindex="-1"></a>  sst4[k] <span class="ot">&lt;-</span> (magnetic[k] <span class="sc">-</span> ymean)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb112-35"><a href="#cb112-35" tabindex="-1"></a>}</span>
<span id="cb112-36"><a href="#cb112-36" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="dv">-2</span>)<span class="sc">*</span><span class="fu">sum</span>(ssr1)<span class="sc">/</span><span class="fu">sum</span>(sst1)</span>
<span id="cb112-37"><a href="#cb112-37" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="dv">-2</span>)<span class="sc">*</span><span class="fu">sum</span>(ssr2)<span class="sc">/</span><span class="fu">sum</span>(sst2)</span>
<span id="cb112-38"><a href="#cb112-38" tabindex="-1"></a>r3 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="dv">-2</span>)<span class="sc">*</span><span class="fu">sum</span>(ssr3)<span class="sc">/</span><span class="fu">sum</span>(sst3)</span>
<span id="cb112-39"><a href="#cb112-39" tabindex="-1"></a>r4 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="dv">-2</span>)<span class="sc">*</span><span class="fu">sum</span>(ssr4)<span class="sc">/</span><span class="fu">sum</span>(sst4)</span>
<span id="cb112-40"><a href="#cb112-40" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">Lin=</span><span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="at">Quad=</span><span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="at">Expo=</span><span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="at">Cubic=</span><span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>)),<span class="dv">3</span>)  <span class="do">## average squared prediction error</span></span></code></pre></div>
<pre><code>##   Lin  Quad  Expo Cubic 
##  19.6  17.9  18.4  18.2</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">Lin_R2=</span>r1, <span class="at">Quad_R2=</span>r2, <span class="at">Expo_R2=</span>r3, <span class="at">Cubic_R2=</span>r4),<span class="dv">3</span>)  <span class="do">## adjusted R^2</span></span></code></pre></div>
<pre><code>##   Lin_R2  Quad_R2  Expo_R2 Cubic_R2 
##    0.488    0.533    0.517    0.524</code></pre>
<p>根据the cross validation procedure计算出4种模型的average squared
prediction error，我们可以选择Quadratic model，因为它的average squared
prediction error最低。<br />
按照maximum adjusted <span class="math inline">\(R^2\)</span>的话，我们可以选择Quadratic
model，因为它的adjusted <span class="math inline">\(R^2\)</span>最大。</p>
</div>
<div id="question-17" class="section level2">
<h2>Question</h2>
<p>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<p>思路：大致过程与例题相同，只需写一个Cramer-von Mises
test函数，然后将检验方法换成自己写的Cramer-von Mises test即可。</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>myFun <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>  w <span class="ot">&lt;-</span> n<span class="sc">*</span>m<span class="sc">/</span>(n<span class="sc">+</span>m)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">sum</span>((<span class="fu">f</span>(x)<span class="sc">-</span><span class="fu">g</span>(x))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">sum</span>((<span class="fu">f</span>(y)<span class="sc">-</span><span class="fu">g</span>(y))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a>}</span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a></span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb116-11"><a href="#cb116-11" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb116-12"><a href="#cb116-12" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb116-13"><a href="#cb116-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb116-14"><a href="#cb116-14" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>;z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y);K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>;n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb116-15"><a href="#cb116-15" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R);t0 <span class="ot">&lt;-</span> <span class="fu">myFun</span>(x, y)</span>
<span id="cb116-16"><a href="#cb116-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb116-17"><a href="#cb116-17" tabindex="-1"></a>  xy <span class="ot">&lt;-</span> <span class="fu">sample</span>(z);</span>
<span id="cb116-18"><a href="#cb116-18" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> xy[<span class="dv">1</span><span class="sc">:</span>n]; y1 <span class="ot">&lt;-</span> xy[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)]</span>
<span id="cb116-19"><a href="#cb116-19" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">myFun</span>(x1,y1)</span>
<span id="cb116-20"><a href="#cb116-20" tabindex="-1"></a>}</span>
<span id="cb116-21"><a href="#cb116-21" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(t0, reps) <span class="sc">&gt;=</span> t0)</span>
<span id="cb116-22"><a href="#cb116-22" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<pre><code>## [1] 0.419</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">hist</span>(reps, <span class="at">main =</span> <span class="st">&quot;the two-sample Cramer-von Mises test&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="st">&quot;reps (p = 0.419)&quot;</span>,<span class="at">breaks =</span> <span class="st">&quot;scott&quot;</span>)</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="fu">points</span>(t0, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>分析：p=0.419不支持分布不同的备选假设，即原假设成立，分布相同。</p>
</div>
<div id="question-18" class="section level2">
<h2>Question</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence[255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<p>思路：先自定义两个向量x和y，利用cor函数计算Spearman等级相关性，然后按照permutation
test的过程计算对应的p值(p_per.test)，把它与cor.test的p值(p_cor.test)相比较。</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">67</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">78</span>, <span class="dv">73</span>, <span class="dv">89</span>, <span class="dv">84</span>, <span class="dv">99</span>, <span class="dv">90</span>, <span class="dv">91</span>)</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">27</span>, <span class="dv">30</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">31</span>, <span class="dv">38</span>, <span class="dv">35</span>, <span class="dv">34</span>, <span class="dv">32</span>)</span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>cor0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>cor1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb119-10"><a href="#cb119-10" tabindex="-1"></a>  xy <span class="ot">&lt;-</span> <span class="fu">sample</span>(z);</span>
<span id="cb119-11"><a href="#cb119-11" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> xy[<span class="dv">1</span><span class="sc">:</span>n]; y1 <span class="ot">&lt;-</span> xy[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)]</span>
<span id="cb119-12"><a href="#cb119-12" tabindex="-1"></a>  cor1[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1, y1, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb119-13"><a href="#cb119-13" tabindex="-1"></a>}</span>
<span id="cb119-14"><a href="#cb119-14" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(cor0, cor1)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(cor0))</span>
<span id="cb119-15"><a href="#cb119-15" tabindex="-1"></a>p_cor.test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb119-16"><a href="#cb119-16" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">correlation=</span>cor0,<span class="at">p_per.test=</span>p,<span class="at">p_cor.test=</span>p_cor.test),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## correlation  p_per.test  p_cor.test 
##       0.782       0.014       0.012</code></pre>
<p>分析：从结果中，我们可以看到Spearman等级相关性为0.782，相应的p值为0.012。这表明两个向量之间存在很强的正相关性，并且相关性的p值小于0.05，因此相关性具有统计显著性。permutation
test的p值为0.014，与cor.test的p值非常接近。</p>
</div>
<div id="question-9.3" class="section level2">
<h2>Question 9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see qcauchy or qt with df=1). Recall
that a Cauchy(<span class="math inline">\(\theta\)</span>,<span class="math inline">\(\eta\)</span>) distribution has density function
<span class="math display">\[ f(x) =
\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},\qquad-\infty&lt;x&lt;\infty,\theta&gt;0\]</span>
The standard Cauchy has the Cauchy(<span class="math inline">\(\theta=1\)</span>,<span class="math inline">\(\eta=0\)</span>) density. (Note that the standard
Cauchy density is equal to the Student t density with one degree of
freedom.)</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<p>思路：确定目标分布为标准柯西分布（其密度函数相当于自由度为1的t分布），然后设置提议分布为正态分布，其均值等于当前状态，标准差为一个小常数，这里取1。然后根据M-H算法流程生成马尔可夫链，丢弃前1000个样本，生成Q-Q图比较观测值的分位数与标准柯西分布的理论分位数，生成标准柯西分布密度叠加的样本直方图。</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){  <span class="do">## standard Cauchy density function</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">1</span>))</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>}</span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb121-7"><a href="#cb121-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb121-8"><a href="#cb121-8" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb121-9"><a href="#cb121-9" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb121-10"><a href="#cb121-10" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb121-11"><a href="#cb121-11" tabindex="-1"></a></span>
<span id="cb121-12"><a href="#cb121-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb121-13"><a href="#cb121-13" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb121-14"><a href="#cb121-14" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,xt,<span class="dv">1</span>)  <span class="do">## proposal distribution N(xt,1)</span></span>
<span id="cb121-15"><a href="#cb121-15" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">f</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, <span class="at">mean =</span> y, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb121-16"><a href="#cb121-16" tabindex="-1"></a>  den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, <span class="at">mean =</span> xt, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb121-17"><a href="#cb121-17" tabindex="-1"></a>  <span class="cf">if</span>(u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den)</span>
<span id="cb121-18"><a href="#cb121-18" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> y      <span class="do">## y被接受</span></span>
<span id="cb121-19"><a href="#cb121-19" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb121-20"><a href="#cb121-20" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> xt     <span class="do">## y被拒绝</span></span>
<span id="cb121-21"><a href="#cb121-21" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span>       <span class="do">## 被拒绝次数</span></span>
<span id="cb121-22"><a href="#cb121-22" tabindex="-1"></a>  }</span>
<span id="cb121-23"><a href="#cb121-23" tabindex="-1"></a>}</span>
<span id="cb121-24"><a href="#cb121-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;reject probablity:&quot;</span>,k<span class="sc">/</span>m)</span></code></pre></div>
<pre><code>## reject probablity: 0.221</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1001</span>          <span class="do">## discard the burnin sample</span></span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> x[b<span class="sc">:</span>m]</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>QR <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(a)   <span class="do">##quantiles of Cauchy</span></span>
<span id="cb123-5"><a href="#cb123-5" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, a)</span>
<span id="cb123-6"><a href="#cb123-6" tabindex="-1"></a><span class="fu">qqplot</span>(QR, Q, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Cauchy Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="fu">hist</span>(y1, <span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a><span class="fu">lines</span>(QR, <span class="fu">f</span>(QR))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>分析：拒绝概率落入10%−40%的区间内，符合马氏链的要求。通过观察直方图，可以认为抽样分布基本符合标准柯西分布。从Q-Q图中可以看出，样本分位数与标准柯西分布理论分位数大致一致。</p>
</div>
<div id="question-9.8" class="section level2">
<h2>Question 9.8</h2>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[f(x,y)\propto\dbinom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\quad
x=0,1,...,n,0\leq y\leq 1.\]</span> It can be shown (see e.g. [23]) that
for fixed a,b,n, the conditional distributions are Binomial<span class="math inline">\((n,y)\)</span> and Beta<span class="math inline">\((x+a,n−x+b)\)</span>. Use the Gibbs sampler to
generate a chain with target joint density <span class="math inline">\(f(x,y)\)</span>.</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<p>思路：先设置a,b,n的值，以及链的初始状态和长度。根据给的条件分布来生成x和y的随机数，然后按照Gibbs采样方法生成具有目标联合密度<span class="math inline">\(f(x,y)\)</span>的马氏链。</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e4</span>               <span class="co">#length of chain</span></span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span>            <span class="co">#burn-in length</span></span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)    <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb125-6"><a href="#cb125-6" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb125-7"><a href="#cb125-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb125-8"><a href="#cb125-8" tabindex="-1"></a></span>
<span id="cb125-9"><a href="#cb125-9" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb125-10"><a href="#cb125-10" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb125-11"><a href="#cb125-11" tabindex="-1"></a>X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(x0,y0)</span>
<span id="cb125-12"><a href="#cb125-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb125-13"><a href="#cb125-13" tabindex="-1"></a>  y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb125-14"><a href="#cb125-14" tabindex="-1"></a>  X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb125-15"><a href="#cb125-15" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb125-16"><a href="#cb125-16" tabindex="-1"></a>  X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb125-17"><a href="#cb125-17" tabindex="-1"></a>}</span>
<span id="cb125-18"><a href="#cb125-18" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb125-19"><a href="#cb125-19" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb125-20"><a href="#cb125-20" tabindex="-1"></a><span class="fu">colMeans</span>(x1)</span></code></pre></div>
<pre><code>## [1] 5.360 0.333</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="fu">cov</span>(x1)</span></code></pre></div>
<pre><code>##        [,1]   [,2]
## [1,] 11.199 0.5074
## [2,]  0.507 0.0316</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="fu">cor</span>(x1)</span></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,] 1.000 0.853
## [2,] 0.853 1.000</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="fu">plot</span>(x1, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]),<span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]), <span class="at">ylim=</span><span class="fu">range</span>(x1[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmAGZmOjpmZjpmZrZmkJBmtv+QOgCQOjqQOmaQ2/+2ZgC2Zma2/7a2///bkDrb/7bb////tmb/25D//7b//9v///+l27H7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHi0lEQVR4nO2d7XqjNhCF2TRx2zj9WLd1d93FNvd/k+UbOwadGTESwpz3R59sKo3E65EERpCsIE6ypTuQOhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCGAsKFsNSwmyDRcOCqpw5AkFFc14n/x/4iA2fQkUbh6Zoz8UVDCDMIOfB1MUVNFruRls7e82LajzMmgZBlv3UyBBxyx7ux7KNr6ahDNlSJdsyJLIgk6vP0pHb0Vx2b8bhDNl3Ebx+KuAgq6HUkv+5Z+iUTU3nAkOB2O/Civosi9HVv7yvej+Oy+cBS4H8QWlk0Ejy9PIEIsuaJiDalWzw3kzNt+MTdLRBaWyio1qSSGDooebasU187gFbeNE0XWCgzKorRpa0GnZVcy1uKch6HMU9TeZ85rzz6CnHmKuCVksSNvRFQkatMwYYoEzqF7iSyZmoMCCHiaS1M6ki1PWnh/mWcQTRdGSnsQkfXP+HPFSQ5QQSNBDygURVF+sNkS8WDURFGeIRc0g3aUVEPS4AIaag9oUCj8HjczDJoICr2KXfbOKTeSPpSDdiBHPQeqOJnYe5PsF4ZMLcn7/ZbHM3wwxbUdTEGRw3rc9Qbar2E1cbUdTEDTn24ttzEFDdVtBY5mp7WgSgsJn0LoFzTjebQyx8IJWuooZXnsiQf4dXVBQn/cUNFm2P6TuV88qKOvR1RpqC35asyC/cBQEyiqPfHuCOEmDsswgUDa0oMfTQ4+OPrOgzNEfH0HnXb2B9WPqrqkyHC67MkHXw9fqdtcTCTIeYrWZy8e35xFknUF/VdtXL7/9EljQ43XFSgSVc1B1W3DqprI63HQJzyNfeohV/CuS05j0bNf/yKVaXF4UHe0LXv7ofj7v3NnT3Vet0G5eeBxY4TJImMgySkH7eu98tQkaja72lrxHBo0MrNUIqraNvXVnQYDLvror7yPI4Mj1Q8xsDsqzL79nbR4BjmUxuSDXwAon6KYzVqtYk0QiTtm7WJBzYK1J0KnKIOnyft79tBJBVkOsXJzqhwinNkV9pky3FIeY4qAfO+oqqFjF1O1GFCQ6+5nsqKug/DzoBtmzGjGHWDhBt8jOpEei9HwOHm8OCjbETElqmVd01KDgvHBbEaR9VuMpVjEF2mc1bFMj/QxS77SPKSjOKuZG/axGVEE6NpNBvstMqDlI9KzG8KHGPJPWEWgVEz2rMXyq4TNIOfPcd9S2oDycdLXxF+St5b6jtgXl4SIIsumobUF5OAoC4SgIhKMgEI6CQDgKAuEoCISjIBCOgkC4YIIse/uUgphB8CfbjtoWdEfpKewFmX+KbVTjgvJwxoJME+euo7YF5eGsBQWBggQdtS0oD2ciKMzAuu+obUF5OGYQCGcjKMjadd9R24LycMwgEI5zEAg3Q1BoLfcdtS0oDzdHUDQoCBBIkGh/0IYFyfYHbVeQcHeHXlDgc54xgggS7g9SC4q3dg2sIoMWSJyeUHOQZH+QPoMWINAqJtsfJNWyoJ+Uz4OWHFgDqQm6yZYl82YgtCDXwyyJDCI3kTMo62n+ZRI0KEsOsVVAQYAlL1ZXwWIXq6shhCDBpYY+aKoVfCoKLlY9e5NgBZ+KzCAEvlj17E2CFfwqwotVz94kWGF2RdOgCVaYXdE0aIIVZlc0DZpghdkVTYMmWGF2xa1AQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAPaC8kz4YuGW5ltK6bt2i+LcvHRf3kxTQdtMh7mgvOx2rjF0/lmjszzQ+oaKvJm2grKZHmtBzZ2Po+KT0v2Vgby5rStvpq3g/ccMrAU175qe2h0zxkmT9nn2Xh+puJmugq6ZG8wF1Zms+biOv5Zzg/BNzUUXW9NMU0rbTIe1oGZeUExCzWvyj/Ku18eraaauoG6mY3FBbTV5yvkJUjfTsfwQa6pNvwX+M55DTNtMx/KTdFNNvgjrJuniXpB+rV98mVf/RaFct8zfGU1giOlPFOuj1E7SmmbaVUzZTIf9pcYp011qFMdy/VVMDW0WyJtpKyib6eDFKoCCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAhAWdd82zwyef21lmJCyoffj8vPPY1WNHyoKK48v34nrw3BpmRNKCLvs3/UYRY5IWVA6vP/U7emxJW9DwQp7FSFvQ9TD9LqdIpC3o+Prfftk5Om1BeXkG1L5o5vKxUCalLOi8q3eFVfuk2ucJFiBhQdfDS/MUyuuP69/fmEGfKSfoZoXPq2d0OMQAFASgIAAFASgoVSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMD/vuNzkTxMs2wAAAAASUVORK5CYII=" /><!-- --></p>
<p>分析：样本的均值、方差和相关性接近真实参数，图中显示出具有正相关的双变量Binomial-Beta分布的椭圆形对称性。</p>
</div>
<div id="question-19" class="section level2">
<h2>Question</h2>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<p>Gelman-Rubin method for Question 9.3</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb132-10"><a href="#cb132-10" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb132-11"><a href="#cb132-11" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb132-12"><a href="#cb132-12" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb132-13"><a href="#cb132-13" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb132-14"><a href="#cb132-14" tabindex="-1"></a>}</span>
<span id="cb132-15"><a href="#cb132-15" tabindex="-1"></a></span>
<span id="cb132-16"><a href="#cb132-16" tabindex="-1"></a>chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb132-17"><a href="#cb132-17" tabindex="-1"></a>  <span class="co">#generates a Metropolis chain for standard Cauchy</span></span>
<span id="cb132-18"><a href="#cb132-18" tabindex="-1"></a>  <span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb132-19"><a href="#cb132-19" tabindex="-1"></a>  <span class="co">#and starting value X1</span></span>
<span id="cb132-20"><a href="#cb132-20" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb132-21"><a href="#cb132-21" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb132-22"><a href="#cb132-22" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb132-23"><a href="#cb132-23" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb132-24"><a href="#cb132-24" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb132-25"><a href="#cb132-25" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma)    <span class="co">#candidate point</span></span>
<span id="cb132-26"><a href="#cb132-26" tabindex="-1"></a>    r1 <span class="ot">&lt;-</span> <span class="fu">dt</span>(y, <span class="at">df =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, y, sigma)</span>
<span id="cb132-27"><a href="#cb132-27" tabindex="-1"></a>    r2 <span class="ot">&lt;-</span> <span class="fu">dt</span>(xt, <span class="at">df =</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">dnorm</span>(y, xt, sigma)</span>
<span id="cb132-28"><a href="#cb132-28" tabindex="-1"></a>    r <span class="ot">&lt;-</span> r1<span class="sc">/</span>r2</span>
<span id="cb132-29"><a href="#cb132-29" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span></span>
<span id="cb132-30"><a href="#cb132-30" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb132-31"><a href="#cb132-31" tabindex="-1"></a>  }</span>
<span id="cb132-32"><a href="#cb132-32" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb132-33"><a href="#cb132-33" tabindex="-1"></a>}</span>
<span id="cb132-34"><a href="#cb132-34" tabindex="-1"></a></span>
<span id="cb132-35"><a href="#cb132-35" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb132-36"><a href="#cb132-36" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>        <span class="co">#parameter of proposal distribution</span></span>
<span id="cb132-37"><a href="#cb132-37" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>            <span class="co">#number of chains to generate</span></span>
<span id="cb132-38"><a href="#cb132-38" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">21000</span>        <span class="co">#length of chains</span></span>
<span id="cb132-39"><a href="#cb132-39" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">12000</span>        <span class="co">#burn-in length</span></span>
<span id="cb132-40"><a href="#cb132-40" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(k)</span>
<span id="cb132-41"><a href="#cb132-41" tabindex="-1"></a></span>
<span id="cb132-42"><a href="#cb132-42" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb132-43"><a href="#cb132-43" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb132-44"><a href="#cb132-44" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb132-45"><a href="#cb132-45" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">chain</span>(sigma, n, x0[i])</span>
<span id="cb132-46"><a href="#cb132-46" tabindex="-1"></a></span>
<span id="cb132-47"><a href="#cb132-47" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb132-48"><a href="#cb132-48" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb132-49"><a href="#cb132-49" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb132-50"><a href="#cb132-50" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb132-51"><a href="#cb132-51" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;R=&quot;</span>,<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## R= 1.09</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6Ojo6OpA6ZmY6ZpA6ZrY6kNtmAABmZmZmtv+QOgCQOjqQZgCQZjqQZpCQtraQ2/+2ZgC22/+2///bkDrb2//b////tmb/25D/27b//7b//9v///9rXMK/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHOElEQVR4nO2diXLbNhgG4dppetiNe0WtGjmW3v8hSxIiRZrHB4K4qNmdaUor4A9kg4sEhJgLLGJyF6B0ECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJECRAkABBAgQJAgsyuyGXoLDh4oEgAYIECJqm63sQNGbQPSNoxHDsQtAI02tgCJoAQQIECRAkQJAAQQJz6RcPQR/58PyOoI+YxR+d7wtcjGIYvQBC0JBRuRA0YPwCEUEDxsVC0AAECbILWr9YkJbsgmKFCwWCBAgSIEiAIAGCBAgSIEiAIAGClpmY4EcSdH61DxQ//BskXComShVH0NE824tTe7EpXDJSCTq/dlqOj982h/PC43F48hE6iqD3ly/t5WmmkZUjqEs3/YrhTmuQ8wuVNuHsDbH6oGsVytUHGcccjF1GNc1/c5Gcs1zB+4sdxWbqTxpBDnm0tUekcMwyJHEF2YrhKmixMHcq6PprPxfPLjiSoGP199d0Q8e0o9hg5+Xw9bfnIB6pk374WnVDT5c8gm5Obj803bBPMSIO8+fXqotOLmi8ZGLaX8oR1E4UD4/fUgua6GtsPZrOM2sNqjg8ZRA09VlXi1YXI1IfdNVSTYeSCxp/trBpPuMoZhvZ+TW/oO7DiZc92QSlDucU1uttWGJBsdfm8ws6/zX3dDVN2k562XvX1AYTJRXSOW/7v/eXh59/+/s/17u25xswak+LsRPHGE3s+5+fq+C/ut62Od+QUYeC3Bq6Xx/0/feZ1zzOZBTUDvpu/aBnJ/3203JXlGlVQwnyGB/W90HdODT7h8+3quEgKHDIuYTLNSjbO2m3PihkyJmE58NiH5RrVSPG7MpzFPtlsQvKVIOizD795kH/iMQ5VjUiTc8jzaTTr2pkeXjxSpglXLSn36iCel1RiHDLIEiAIAGCBAgS7FFQwnAIkvEQlDbe+sAISlsCBKUNh6DU8dYHjiMoWNQ7FRRocJ7eHBWGzEvPZvB7W6JuLNh87OAJV4ULJOhum1gYQVFPKbgDQXFPcdizoDYGgiZuN5fr4nrsY0DKEbRqKLJfPjHhyzXOKXjCVeGGBxauEWRs+ujHyOR+1PAVdK098Y/Z2aegdVt8NrFTQWELEySrdWVy3kDlJSjl+VVxBLlvoJoXtJBhQj9xBK3Y/jInaKl7SXoAWhRBKzZQzQpayHD/gnxqkHEUlPoEvVh9kOsGKtP/oPtw5vuBUd+MzRBpFHPeQNVVnA+CJjOc8xaT7POgdjbcE2QmBF3TpD+hMreg29kQl+uzVff1t+Gg3x6PcE+CTsY8fFXhbKsxpidoIkeT5LlrikiCDsY815vNewP+XDgz+M6kGf5G7zp579PmHDphzaHqnA9N7XHaJ31b4+jXkn6DytG42pxDJ7xcJ4pvP9aCnHba9wQNktx+HtatlEQS1BwsUH/tbtVO+2Et6Q/qdybo9kVMq8o13GjguvTGrjx+YnXSRzt8ncxMH+0sKOpXgF3IPg+a/7RdtMjqJ7Ug8bXwidlzbmILWve18CKUDCm4iZVBWYIKBEGCSIJ2etjtBLHeKO7zsNsJsr2T3g0xBDmsajgHLSlJsPsdapBz0JKShLtfr2o4By0pScD75aqGc9CSkkS93zdoSUlC37/0lUznoCUlCX0/ggQIEiBIoAXdE7t5eMoFggQIEiBIgCABggQIEiBIgCABggQIEiBIEF7Q0iZYxaF5l9tFGF9oun+faVOUG8EFnaoynDwNnZqX3V2E8YWm3uLV7O/aFKVHaEH2Xcjhyefe95daUBdhfOGS/dPczZ4lCy3o7VNdv+e2Dy1zfPyjEtRFGF/oEJ2gTVH6BBe0uEtY3Vr3QV2E8YVDkLaJbYvSI7Qg28h9OqG6CdSCugjjC6cC2J54Y5Qb5QiqV7O3CzpUNeTt03O5grybWHPj5iZ263FKbWLenfTxui3ly6butasmxXbSW4Z5W4M2DdDWQlVNih3mN00U7Ux60xSv7YOKnSg2bWXjo0YXYXzhEKJqps/TN3uVjIdVAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIUL2jLUn8IShdU7+fx3iwSgsIFNUd+2q2rmShcUAOCBEea2BIns3xYUWTKF1Q3MXFeUUz2ICjrMLYLQXbvah4KF9Rt681WgsIF9XZOZ6J0Qc223nwNbAeCcoMgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBL8D89yIMgKMHOgAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb135-6"><a href="#cb135-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>分析：在time 12001 to 21000的<span class="math inline">\(\hat{R}\)</span>图中表明，链在大约2100次迭代内已经大致收敛到目标分布。图中的虚线位于<span class="math inline">\(\hat{R}=1.2\)</span>。<br />
Gelman-Rubin method for Question 9.8</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb136-7"><a href="#cb136-7" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb136-8"><a href="#cb136-8" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb136-9"><a href="#cb136-9" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb136-10"><a href="#cb136-10" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb136-11"><a href="#cb136-11" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb136-12"><a href="#cb136-12" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb136-13"><a href="#cb136-13" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb136-14"><a href="#cb136-14" tabindex="-1"></a>}</span>
<span id="cb136-15"><a href="#cb136-15" tabindex="-1"></a></span>
<span id="cb136-16"><a href="#cb136-16" tabindex="-1"></a>chain <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n, N, X1, Y1) {</span>
<span id="cb136-17"><a href="#cb136-17" tabindex="-1"></a>  <span class="co">#generates a Metropolis chain for target distribution</span></span>
<span id="cb136-18"><a href="#cb136-18" tabindex="-1"></a>  <span class="co">#with the conditional distributions are Binomial(n,y) and Beta(x+a,n−x+b)</span></span>
<span id="cb136-19"><a href="#cb136-19" tabindex="-1"></a>  <span class="co">#and starting value X1,Y1</span></span>
<span id="cb136-20"><a href="#cb136-20" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb136-21"><a href="#cb136-21" tabindex="-1"></a>  x[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(X1,Y1)</span>
<span id="cb136-22"><a href="#cb136-22" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb136-23"><a href="#cb136-23" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb136-24"><a href="#cb136-24" tabindex="-1"></a>    x[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,Y)</span>
<span id="cb136-25"><a href="#cb136-25" tabindex="-1"></a>    X <span class="ot">&lt;-</span> x[i,<span class="dv">1</span>]</span>
<span id="cb136-26"><a href="#cb136-26" tabindex="-1"></a>    x[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X<span class="sc">+</span>a,n<span class="sc">-</span>X<span class="sc">+</span>b)</span>
<span id="cb136-27"><a href="#cb136-27" tabindex="-1"></a>  }</span>
<span id="cb136-28"><a href="#cb136-28" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb136-29"><a href="#cb136-29" tabindex="-1"></a>}</span>
<span id="cb136-30"><a href="#cb136-30" tabindex="-1"></a></span>
<span id="cb136-31"><a href="#cb136-31" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb136-32"><a href="#cb136-32" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb136-33"><a href="#cb136-33" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb136-34"><a href="#cb136-34" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb136-35"><a href="#cb136-35" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>            <span class="co">#number of chains to generate</span></span>
<span id="cb136-36"><a href="#cb136-36" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>        <span class="co">#length of chains</span></span>
<span id="cb136-37"><a href="#cb136-37" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">2000</span>      <span class="co">#burn-in length</span></span>
<span id="cb136-38"><a href="#cb136-38" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n,k,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb136-39"><a href="#cb136-39" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">runif</span>(k)</span>
<span id="cb136-40"><a href="#cb136-40" tabindex="-1"></a></span>
<span id="cb136-41"><a href="#cb136-41" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb136-42"><a href="#cb136-42" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>,<span class="at">dim =</span> <span class="fu">c</span>(N,<span class="dv">2</span>,k))</span>
<span id="cb136-43"><a href="#cb136-43" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb136-44"><a href="#cb136-44" tabindex="-1"></a>  X[ , ,i] <span class="ot">&lt;-</span> <span class="fu">chain</span>(a, b, n, N, x0[i], y0[i])</span>
<span id="cb136-45"><a href="#cb136-45" tabindex="-1"></a></span>
<span id="cb136-46"><a href="#cb136-46" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb136-47"><a href="#cb136-47" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">3</span>, cumsum))</span>
<span id="cb136-48"><a href="#cb136-48" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb136-49"><a href="#cb136-49" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb136-50"><a href="#cb136-50" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.01</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>N)], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, (<span class="dv">2</span><span class="sc">*</span>N))</span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>N))</span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a><span class="fu">plot</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>N)], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>分析：在time 2000 to 20000的<span class="math inline">\(\hat{R}\)</span>图中表明，链在大约9000次迭代内已经大致收敛到目标分布。图中的虚线位于<span class="math inline">\(\hat{R}=1.2\)</span>。</p>
</div>
<div id="question-20" class="section level2">
<h2>Question</h2>
<ul>
<li>Algorithm (continuous situation)
<ul>
<li>Target pdf: <span class="math inline">\(f(x)\)</span>.</li>
<li>Replace <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> with <span class="math inline">\(s\)</span> and <span class="math inline">\(r\)</span>.</li>
<li>Proposal distribution (pdf): <span class="math inline">\(g(r|s)\)</span>.</li>
<li>Acceptance probability: <span class="math inline">\(\alpha(s,r)=\min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}\)</span>.</li>
<li>Transition kernel (mixture distribution): <span class="math inline">\(K(r,s)=I(s\not=r)\alpha(r,s)g(s|r)+I(s=r)[1-\int
\alpha(r,s)g(s|r)]\)</span>.</li>
<li>Stationarity: <span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span>. Proof the
Stationarity of Metropolis-Hastings sampler Algorithm in continuous
situation.</li>
</ul></li>
</ul>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<p>由Transition kernel (mixture distribution)可得等式： <span class="math display">\[K(s,r)f(s)=I(r\not=s)\alpha(s,r)g(r|s)f(s)+I(r=s)[1-\int
\alpha(s,r)g(r|s)f(s)]\]</span> 又根据Acceptance probability: <span class="math inline">\(\alpha(s,r)=\min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}\)</span>可得
<span class="math display">\[\begin{align}
K(s,r)f(s) &amp;= I(r\not=s)\alpha(s,r)g(r|s)f(s)+I(r=s)[1-\int
\alpha(s,r)g(r|s)f(s)]\\
&amp;=
I(r\not=s)\min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}g(r|s)f(s)+I(r=s)[1-\int\min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}g(r|s)f(s)]\\
&amp;=
I(r\not=s)\min\{f(r)g(s|r),g(r|s)f(s)\}+I(r=s)[1-\int\min\{f(r)g(s|r),g(r|s)f(s)\}]\\
&amp;=
I(r\not=s)\min\{1,\frac{f(s)g(r|s)}{f(r)g(s|r)}\}g(s|r)f(r)+I(r=s)[1-\int\min\{1,\frac{f(s)g(r|s)}{f(r)g(s|r)}\}g(s|r)f(r)]\\
&amp;= I(s\not=r)\alpha(r,s)g(s|r)f(r)+I(s=r)[1-\int
\alpha(r,s)g(s|r)f(r)]\\
&amp;= K(r,s)f(r)
\end{align}\]</span> 至此，成功证明了在continuous
situation中，Metropolis-Hastings采样算法的平稳性，即<span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span>.</p>
</div>
<div id="exercise-11.3" class="section level2">
<h2>Exercise 11.3</h2>
</div>
<div id="question-21" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: lower-alpha">
<li>Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in <span class="math display">\[\sum_{k=0}^\infty
\frac{(-1)^k}{k!2^k}\frac{||a||^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)},\]</span>
where d ≥ 1 is an integer, <span class="math inline">\(a\)</span> is a
vector in <span class="math inline">\(R^d\)</span>, and <span class="math inline">\(||·||\)</span> denotes the Euclidean norm. Perform
the arithmetic so that the coefficients can be computed for (almost)
arbitrarily large k and d. (This sum converges for all <span class="math inline">\(a \in R^d\)</span>).</li>
<li>Modify the function so that it computes and returns the sum.</li>
<li>Evaluate the sum when <span class="math inline">\(a
=(1,2)^T\)</span>.</li>
</ol>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<p>思路：先编写函数计算第k个项，然后再写一个函数用来计算整个级数的和，由于上界是无穷大，所以需要设置一个阈值来停止累加，我设置的阈值为1e-10，即当项绝对值小于1e-10时，认为其对求和的贡献可忽略不计。最后设置d的值，计算当向量a=(1,2)时的总和。需要注意的是，要满足整数d
≥
1且可以很大，那么就需要对我们第一个函数进行修改，将gamma函数改成lgamma函数，就可以处理非常大的数值，因为它避免了直接计算阶乘，而是计算其对数值。</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="do">## function to compute the kth term</span></span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a>compute_kth_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, d, a) {</span>
<span id="cb140-3"><a href="#cb140-3" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># 计算向量a的欧几里得范数</span></span>
<span id="cb140-4"><a href="#cb140-4" tabindex="-1"></a>  kth_term <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">/</span> (<span class="dv">2</span><span class="sc">^</span>k) <span class="sc">*</span> (norm_a<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">/</span> ((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k <span class="sc">+</span> d<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb140-5"><a href="#cb140-5" tabindex="-1"></a>  <span class="fu">return</span>(kth_term)</span>
<span id="cb140-6"><a href="#cb140-6" tabindex="-1"></a>}</span>
<span id="cb140-7"><a href="#cb140-7" tabindex="-1"></a></span>
<span id="cb140-8"><a href="#cb140-8" tabindex="-1"></a><span class="do">## function to compute and return the sum</span></span>
<span id="cb140-9"><a href="#cb140-9" tabindex="-1"></a>compute_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(d, a, <span class="at">tol =</span> <span class="fl">1e-10</span>) {</span>
<span id="cb140-10"><a href="#cb140-10" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb140-11"><a href="#cb140-11" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb140-12"><a href="#cb140-12" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb140-13"><a href="#cb140-13" tabindex="-1"></a>  <span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb140-14"><a href="#cb140-14" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">compute_kth_term</span>(k, d, a)</span>
<span id="cb140-15"><a href="#cb140-15" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(term) <span class="sc">&lt;</span> tol) {</span>
<span id="cb140-16"><a href="#cb140-16" tabindex="-1"></a>      <span class="cf">break</span>    <span class="co"># 设置一个阈值来确定何时停止累加，当项绝对值小于1e-10时，认为其对求和的贡献可忽略不计。</span></span>
<span id="cb140-17"><a href="#cb140-17" tabindex="-1"></a>    }</span>
<span id="cb140-18"><a href="#cb140-18" tabindex="-1"></a>    sum <span class="ot">&lt;-</span> sum <span class="sc">+</span> term</span>
<span id="cb140-19"><a href="#cb140-19" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb140-20"><a href="#cb140-20" tabindex="-1"></a>  }</span>
<span id="cb140-21"><a href="#cb140-21" tabindex="-1"></a>  <span class="fu">return</span>(sum)</span>
<span id="cb140-22"><a href="#cb140-22" tabindex="-1"></a>}</span>
<span id="cb140-23"><a href="#cb140-23" tabindex="-1"></a></span>
<span id="cb140-24"><a href="#cb140-24" tabindex="-1"></a><span class="do">## Evaluate the sum when a = (1,2)</span></span>
<span id="cb140-25"><a href="#cb140-25" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb140-26"><a href="#cb140-26" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">1</span>     <span class="co"># d ≥ 1 is an integer</span></span>
<span id="cb140-27"><a href="#cb140-27" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">compute_sum</span>(d,a))</span></code></pre></div>
<pre><code>## [1] 1.81</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb142-2"><a href="#cb142-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">compute_sum</span>(d,a))</span></code></pre></div>
<pre><code>## [1] 0.0313</code></pre>
<p>分析：当a=(1,2)，d=1时，总和为1.813545；当d=1e4时，总和为0.03132816。</p>
</div>
<div id="exercise-11.5" class="section level2">
<h2>Exercise 11.5</h2>
</div>
<div id="question-22" class="section level2">
<h2>Question</h2>
Write a function to solve the equation
<span class="math display">\[\begin{aligned}
\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)}
\Gamma\left(\frac{k-1}{2}\right)}
\int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u \\
=\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k}
\Gamma\left(\frac{k}{2}\right)}
\int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u
\end{aligned}\]</span>
<p>for <span class="math inline">\(a\)</span>, where <span class="math display">\[ c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}} \]</span>
Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<p>思路：先利用uniroot函数求例题11.4的根，然后再求11.5的根，需要注意的是当k很大的时候，计算<span class="math inline">\(\Gamma(k)\)</span>会出现报错，因为算术溢出，所以需要log取对数转换一下。然后利用uniroot函数求根时，需要寻找到合适的上下界，确保两端点的正负号相反。</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(k)</span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a>eps <span class="ot">&lt;-</span> .Machine<span class="sc">$</span>double.eps <span class="sc">^</span> <span class="fl">0.25</span></span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a></span>
<span id="cb144-6"><a href="#cb144-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb144-7"><a href="#cb144-7" tabindex="-1"></a>  fa <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb144-8"><a href="#cb144-8" tabindex="-1"></a>    num1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> (k[i] <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k[i] <span class="sc">-</span> a <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb144-9"><a href="#cb144-9" tabindex="-1"></a>    num2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a <span class="sc">^</span> <span class="dv">2</span> <span class="sc">*</span> k[i] <span class="sc">/</span> (k[i] <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb144-10"><a href="#cb144-10" tabindex="-1"></a>    <span class="fu">pt</span>(num2, k[i]) <span class="sc">-</span> <span class="fu">pt</span>(num1, k[i] <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb144-11"><a href="#cb144-11" tabindex="-1"></a>  }</span>
<span id="cb144-12"><a href="#cb144-12" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(fa,<span class="at">lower =</span> eps, <span class="at">upper =</span> <span class="fu">sqrt</span>(k[i]<span class="sc">-</span>eps))</span>
<span id="cb144-13"><a href="#cb144-13" tabindex="-1"></a>  A[i] <span class="ot">&lt;-</span> out<span class="sc">$</span>root        <span class="co"># 11.4的根</span></span>
<span id="cb144-14"><a href="#cb144-14" tabindex="-1"></a>}</span>
<span id="cb144-15"><a href="#cb144-15" tabindex="-1"></a></span>
<span id="cb144-16"><a href="#cb144-16" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)            <span class="co"># 11.5的根</span></span>
<span id="cb144-17"><a href="#cb144-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb144-18"><a href="#cb144-18" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb144-19"><a href="#cb144-19" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(x<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(<span class="fu">log</span>(pi<span class="sc">*</span>(x<span class="dv">-1</span>))) <span class="sc">-</span> <span class="fu">lgamma</span>((x<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb144-20"><a href="#cb144-20" tabindex="-1"></a>  }</span>
<span id="cb144-21"><a href="#cb144-21" tabindex="-1"></a>  h <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb144-22"><a href="#cb144-22" tabindex="-1"></a>    num1 <span class="ot">&lt;-</span> (<span class="fu">f</span>(k[i])<span class="sc">*</span><span class="fu">integrate</span>(<span class="cf">function</span>(u)(<span class="dv">1</span> <span class="sc">+</span> (u<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(k[i]<span class="sc">-</span><span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>k[i]<span class="sc">/</span><span class="dv">2</span>), <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(k[i]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span>(k[i]<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">$</span>value)</span>
<span id="cb144-23"><a href="#cb144-23" tabindex="-1"></a>    num2 <span class="ot">&lt;-</span> (<span class="fu">f</span>(k[i]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">integrate</span>(<span class="cf">function</span>(u)(<span class="dv">1</span> <span class="sc">+</span> (u<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>k[i])<span class="sc">^</span>(<span class="sc">-</span>(k[i]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>), <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>k[i]<span class="sc">/</span>(k[i]<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">$</span>value)</span>
<span id="cb144-24"><a href="#cb144-24" tabindex="-1"></a>    <span class="fu">return</span>(num1 <span class="sc">-</span> num2)</span>
<span id="cb144-25"><a href="#cb144-25" tabindex="-1"></a>  }</span>
<span id="cb144-26"><a href="#cb144-26" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">&lt;</span><span class="dv">20</span>)  <span class="co"># 为不同的k值寻找不同的上下界</span></span>
<span id="cb144-27"><a href="#cb144-27" tabindex="-1"></a>    B[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(h, <span class="at">lower =</span> eps, <span class="at">upper =</span> <span class="fu">sqrt</span>(k[i]<span class="sc">-</span>eps)<span class="sc">-</span><span class="fl">0.1</span>)<span class="sc">$</span>root</span>
<span id="cb144-28"><a href="#cb144-28" tabindex="-1"></a>  <span class="cf">if</span>(<span class="dv">20</span><span class="sc">&lt;=</span>i <span class="sc">&amp;</span> i<span class="sc">&lt;=</span><span class="dv">21</span>)</span>
<span id="cb144-29"><a href="#cb144-29" tabindex="-1"></a>    B[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(h, <span class="at">lower =</span> eps, <span class="at">upper =</span> <span class="fu">sqrt</span>(k[i]<span class="sc">-</span>eps))<span class="sc">$</span>root</span>
<span id="cb144-30"><a href="#cb144-30" tabindex="-1"></a>  <span class="cf">if</span>(<span class="dv">22</span><span class="sc">&lt;=</span>i <span class="sc">&amp;</span> i<span class="sc">&lt;=</span><span class="dv">23</span>)</span>
<span id="cb144-31"><a href="#cb144-31" tabindex="-1"></a>    B[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(h, <span class="at">lower =</span> <span class="dv">4</span>, <span class="at">upper =</span> <span class="fu">sqrt</span>(k[i]))<span class="sc">$</span>root</span>
<span id="cb144-32"><a href="#cb144-32" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">24</span>)</span>
<span id="cb144-33"><a href="#cb144-33" tabindex="-1"></a>    B[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(h, <span class="at">lower =</span> <span class="fu">sqrt</span>(k[i])<span class="sc">-</span><span class="fl">0.03</span>, <span class="at">upper =</span> <span class="fu">sqrt</span>(k[i])<span class="sc">-</span><span class="fl">0.001</span>)<span class="sc">$</span>root</span>
<span id="cb144-34"><a href="#cb144-34" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">25</span>)</span>
<span id="cb144-35"><a href="#cb144-35" tabindex="-1"></a>    B[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(h, <span class="at">lower =</span> <span class="fu">sqrt</span>(k[i])<span class="sc">-</span><span class="fl">0.0037</span>, <span class="at">upper =</span> <span class="fu">sqrt</span>(k[i]))<span class="sc">$</span>root</span>
<span id="cb144-36"><a href="#cb144-36" tabindex="-1"></a>}</span>
<span id="cb144-37"><a href="#cb144-37" tabindex="-1"></a></span>
<span id="cb144-38"><a href="#cb144-38" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(k,A,B))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">A</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.49</td>
<td align="right">1.49</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.53</td>
<td align="right">1.53</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.56</td>
<td align="right">1.56</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.58</td>
<td align="right">1.58</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.60</td>
<td align="right">1.60</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.61</td>
<td align="right">1.61</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.62</td>
<td align="right">1.62</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.63</td>
<td align="right">1.63</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.64</td>
<td align="right">1.64</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.65</td>
<td align="right">1.65</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.65</td>
<td align="right">1.65</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.66</td>
<td align="right">1.66</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.66</td>
<td align="right">1.66</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.67</td>
<td align="right">1.67</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.67</td>
<td align="right">1.67</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.67</td>
<td align="right">1.67</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.68</td>
<td align="right">1.68</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.68</td>
<td align="right">1.68</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.68</td>
<td align="right">1.68</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">4.80</td>
<td align="right">4.80</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">4.90</td>
<td align="right">4.90</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">5.00</td>
<td align="right">5.00</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">10.00</td>
<td align="right">10.00</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">22.36</td>
<td align="right">22.36</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">31.62</td>
<td align="right">31.62</td>
</tr>
</tbody>
</table>
<p>分析：根据表格中的数据，可以发现当k值相同时，两者的根相同。</p>
</div>
<div id="question-23" class="section level2">
<h2>Question</h2>
<p>Suppose <span class="math inline">\(T_1,...,T_n\)</span> are i.i.d.
samples drawn from the exponential distribution with expectation λ.
Those values greater than <span class="math inline">\(\tau\)</span> are
not observed due to right censorship, so that the observed values are
<span class="math inline">\(Y_i = T_iI(T_i ≤ \tau) + \tau I(T_i &gt;
\tau), i = 1,...,n.\)</span> Suppose <span class="math inline">\(\tau =
1\)</span> and the observed <span class="math inline">\(Y_i\)</span>
values are as follows: <span class="math display">\[0.54,
0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85\]</span> Use the E-M
algorithm to estimate λ, compare your result with the observed data MLE
(note: <span class="math inline">\(Y_i\)</span> follows a mixture
distribution).</p>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<p>思路：首先初始化参数λ，然后通过EM算法迭代更新λ的估计值，直到收敛。在E-step中，计算每个样本是否被删失的概率，这通过指数分布的累积分布函数来实现。在M-step中，根据这些概率更新λ的估计值。最后，将EM算法的结果与MLE的结果进行比较。</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a><span class="co"># 观察到的数据</span></span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb145-3"><a href="#cb145-3" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" tabindex="-1"></a><span class="co"># 初始化参数</span></span>
<span id="cb145-5"><a href="#cb145-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y) <span class="co"># 样本数量</span></span>
<span id="cb145-6"><a href="#cb145-6" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb145-7"><a href="#cb145-7" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(Y[Y <span class="sc">&lt;=</span> tau]) <span class="co"># 初始估计λ_0</span></span>
<span id="cb145-8"><a href="#cb145-8" tabindex="-1"></a></span>
<span id="cb145-9"><a href="#cb145-9" tabindex="-1"></a><span class="co"># EM算法</span></span>
<span id="cb145-10"><a href="#cb145-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb145-11"><a href="#cb145-11" tabindex="-1"></a>  <span class="co"># E-step: 计算每个样本的潜在分类概率（是否被删失）</span></span>
<span id="cb145-12"><a href="#cb145-12" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">pexp</span>(Y, <span class="at">rate =</span> lambda)</span>
<span id="cb145-13"><a href="#cb145-13" tabindex="-1"></a>  </span>
<span id="cb145-14"><a href="#cb145-14" tabindex="-1"></a>  <span class="co"># M-step: 更新lambda参数</span></span>
<span id="cb145-15"><a href="#cb145-15" tabindex="-1"></a>  lambda_new <span class="ot">&lt;-</span> n <span class="sc">/</span> <span class="fu">sum</span>(Y <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> Z) <span class="sc">+</span> tau <span class="sc">*</span> Z)</span>
<span id="cb145-16"><a href="#cb145-16" tabindex="-1"></a>  </span>
<span id="cb145-17"><a href="#cb145-17" tabindex="-1"></a>  <span class="co"># 检查收敛性</span></span>
<span id="cb145-18"><a href="#cb145-18" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(lambda_new <span class="sc">-</span> lambda) <span class="sc">&lt;</span> <span class="fl">1e-6</span>) {</span>
<span id="cb145-19"><a href="#cb145-19" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb145-20"><a href="#cb145-20" tabindex="-1"></a>  }</span>
<span id="cb145-21"><a href="#cb145-21" tabindex="-1"></a>  </span>
<span id="cb145-22"><a href="#cb145-22" tabindex="-1"></a>  <span class="co"># 更新参数和对数似然</span></span>
<span id="cb145-23"><a href="#cb145-23" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb145-24"><a href="#cb145-24" tabindex="-1"></a>}</span>
<span id="cb145-25"><a href="#cb145-25" tabindex="-1"></a></span>
<span id="cb145-26"><a href="#cb145-26" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb145-27"><a href="#cb145-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated lambda using EM algorithm:&quot;</span>, lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimated lambda using EM algorithm: 1.25</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a><span class="co"># 计算MLE</span></span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(Y[Y <span class="sc">&lt;=</span> tau])</span>
<span id="cb147-3"><a href="#cb147-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated lambda using MLE:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimated lambda using MLE: 1.48</code></pre>
<p>分析：EM算法估计的参数值与观察数据的最大似然估计(MLE)相比，有一点差距，分析原因可能是更新λ参数的公式需要改进。</p>
</div>
<div id="question-24" class="section level2">
<h2>Question</h2>
<p>Use the simplex algorithm to solve the following problem.<br />
Minimize <span class="math inline">\(4x+2y+9z\)</span> subject to <span class="math display">\[2x+y+z≤2\]</span> <span class="math display">\[x−y+3z≤3\]</span> <span class="math display">\[x≥0,y≥0,z≥0.\]</span></p>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<p>思路：将约束条件和目标函数的参数写成向量形式，代入simplex()函数，因为求的是最小化，所以maxi选项选择FALSE。</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb149-3"><a href="#cb149-3" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb149-4"><a href="#cb149-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb149-5"><a href="#cb149-5" tabindex="-1"></a><span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">maxi =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Linear Programming Results
## 
## Call : simplex(a = a, A1 = A1, b1 = b1, maxi = FALSE)
## 
## Minimization Problem with Objective Function Coefficients
## x1 x2 x3 
##  4  2  9 
## 
## 
## Optimal solution has the following values
## x1 x2 x3 
##  0  0  0 
## The optimal value of the objective  function is 0.</code></pre>
<p>分析：由运行结果可知，当x=y=z=0时，目标函数值最小，最小值为0.</p>
</div>
<div id="question-25" class="section level2">
<h2>Question</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars
using the formulas stored in this list:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb151-2"><a href="#cb151-2" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb151-3"><a href="#cb151-3" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb151-4"><a href="#cb151-4" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb151-5"><a href="#cb151-5" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb151-6"><a href="#cb151-6" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<p>思路：将formulas列表中的每一个元素代入到lm()函数中，一种方法是利用for循环，另外一种方法是直接使用lapply函数，比较两者生成的结果是否相同。</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb152-3"><a href="#cb152-3" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb152-5"><a href="#cb152-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb152-6"><a href="#cb152-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb152-7"><a href="#cb152-7" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb152-8"><a href="#cb152-8" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb152-9"><a href="#cb152-9" tabindex="-1"></a>)</span>
<span id="cb152-10"><a href="#cb152-10" tabindex="-1"></a></span>
<span id="cb152-11"><a href="#cb152-11" tabindex="-1"></a><span class="do">## use for loops to fit linear models to the mtcars</span></span>
<span id="cb152-12"><a href="#cb152-12" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(formulas))</span>
<span id="cb152-13"><a href="#cb152-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb152-14"><a href="#cb152-14" tabindex="-1"></a>  out1[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], mtcars)</span>
<span id="cb152-15"><a href="#cb152-15" tabindex="-1"></a>}</span>
<span id="cb152-16"><a href="#cb152-16" tabindex="-1"></a></span>
<span id="cb152-17"><a href="#cb152-17" tabindex="-1"></a><span class="do">## use lapply() to fit linear models to the mtcars</span></span>
<span id="cb152-18"><a href="#cb152-18" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(i) {<span class="fu">lm</span>(i, mtcars)})</span>
<span id="cb152-19"><a href="#cb152-19" tabindex="-1"></a></span>
<span id="cb152-20"><a href="#cb152-20" tabindex="-1"></a>out1</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##     29.5999      -0.0412  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##        10.8       1557.7  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##     34.9606      -0.0177      -3.3508  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##        19.0       1142.6         -1.8</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a>out2</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##     29.5999      -0.0412  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##        10.8       1557.7  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##     34.9606      -0.0177      -3.3508  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##        19.0       1142.6         -1.8</code></pre>
<p>分析：使用for循环和使用lapply函数的最终结果是一致的，但是前者在迭代列表中的元素时相对冗长繁琐，而lapply函数更加简洁，避免了一段循环代码。</p>
</div>
<div id="question-26" class="section level2">
<h2>Question</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of
mtcars in the list below by using a for loop and lapply(). Can you do it
without an anonymous function?</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb156-3"><a href="#cb156-3" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb156-4"><a href="#cb156-4" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="answer-30" class="section level2">
<h2>Answer</h2>
<p>思路：与上一题类似，不同之处在于使用lapply函数时不使用匿名函数，这样的话直接调用lm函数，只需在后面加上参数formula
= mpg ~ disp即可。</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb157-2"><a href="#cb157-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb157-3"><a href="#cb157-3" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb157-5"><a href="#cb157-5" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb157-6"><a href="#cb157-6" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-7"><a href="#cb157-7" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb157-8"><a href="#cb157-8" tabindex="-1"></a>})</span>
<span id="cb157-9"><a href="#cb157-9" tabindex="-1"></a></span>
<span id="cb157-10"><a href="#cb157-10" tabindex="-1"></a><span class="do">## use for loops</span></span>
<span id="cb157-11"><a href="#cb157-11" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(bootstraps))</span>
<span id="cb157-12"><a href="#cb157-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb157-13"><a href="#cb157-13" tabindex="-1"></a>  out1[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, bootstraps[[i]])</span>
<span id="cb157-14"><a href="#cb157-14" tabindex="-1"></a>}</span>
<span id="cb157-15"><a href="#cb157-15" tabindex="-1"></a></span>
<span id="cb157-16"><a href="#cb157-16" tabindex="-1"></a><span class="do">## use lapply() without an anonymous function</span></span>
<span id="cb157-17"><a href="#cb157-17" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span>
<span id="cb157-18"><a href="#cb157-18" tabindex="-1"></a></span>
<span id="cb157-19"><a href="#cb157-19" tabindex="-1"></a>out1</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.2342      -0.0436  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.0705      -0.0379  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.0843      -0.0445  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.7456      -0.0365  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.2791      -0.0381  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     31.8727      -0.0507  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##      30.285       -0.043  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.3214      -0.0399  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.8229      -0.0389  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     31.5027      -0.0473</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a>out2</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.2342      -0.0436  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.0705      -0.0379  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.0843      -0.0445  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.7456      -0.0365  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.2791      -0.0381  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     31.8727      -0.0507  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##      30.285       -0.043  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.3214      -0.0399  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.8229      -0.0389  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     31.5027      -0.0473</code></pre>
<p>分析：out1和out2依然相同，使用lapply函数更加简洁明了。</p>
</div>
<div id="question-27" class="section level2">
<h2>Question</h2>
<p>For each model in the previous two exercises, extract R2 using the
function below.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
</div>
<div id="answer-31" class="section level2">
<h2>Answer</h2>
<p>思路：先计算模型，然后调用提供的rsq函数提取每个模型的<span class="math inline">\(R^2\)</span>即可。</p>
<div id="first-model" class="section level3">
<h3>First model</h3>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb162-2"><a href="#cb162-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb162-3"><a href="#cb162-3" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb162-5"><a href="#cb162-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb162-6"><a href="#cb162-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb162-7"><a href="#cb162-7" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb162-8"><a href="#cb162-8" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb162-9"><a href="#cb162-9" tabindex="-1"></a>)</span>
<span id="cb162-10"><a href="#cb162-10" tabindex="-1"></a></span>
<span id="cb162-11"><a href="#cb162-11" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb162-12"><a href="#cb162-12" tabindex="-1"></a></span>
<span id="cb162-13"><a href="#cb162-13" tabindex="-1"></a><span class="do">## use lapply() to fit linear models to the mtcars</span></span>
<span id="cb162-14"><a href="#cb162-14" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(i) {<span class="fu">rsq</span>(<span class="fu">lm</span>(i, mtcars))})</span>
<span id="cb162-15"><a href="#cb162-15" tabindex="-1"></a></span>
<span id="cb162-16"><a href="#cb162-16" tabindex="-1"></a>out</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.718
## 
## [[2]]
## [1] 0.86
## 
## [[3]]
## [1] 0.781
## 
## [[4]]
## [1] 0.884</code></pre>
</div>
<div id="second-model" class="section level3">
<h3>Second model</h3>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb164-2"><a href="#cb164-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb164-3"><a href="#cb164-3" tabindex="-1"></a></span>
<span id="cb164-4"><a href="#cb164-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb164-5"><a href="#cb164-5" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb164-6"><a href="#cb164-6" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb164-7"><a href="#cb164-7" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb164-8"><a href="#cb164-8" tabindex="-1"></a>})</span>
<span id="cb164-9"><a href="#cb164-9" tabindex="-1"></a></span>
<span id="cb164-10"><a href="#cb164-10" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb164-11"><a href="#cb164-11" tabindex="-1"></a></span>
<span id="cb164-12"><a href="#cb164-12" tabindex="-1"></a><span class="do">## use lapply() without an anonymous function</span></span>
<span id="cb164-13"><a href="#cb164-13" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span>
<span id="cb164-14"><a href="#cb164-14" tabindex="-1"></a></span>
<span id="cb164-15"><a href="#cb164-15" tabindex="-1"></a><span class="do">## extract R2</span></span>
<span id="cb164-16"><a href="#cb164-16" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(out))</span>
<span id="cb164-17"><a href="#cb164-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(out)) {</span>
<span id="cb164-18"><a href="#cb164-18" tabindex="-1"></a>  res[i] <span class="ot">&lt;-</span> <span class="fu">rsq</span>(out[[i]])</span>
<span id="cb164-19"><a href="#cb164-19" tabindex="-1"></a>}</span>
<span id="cb164-20"><a href="#cb164-20" tabindex="-1"></a></span>
<span id="cb164-21"><a href="#cb164-21" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>##  [1] 0.763 0.688 0.744 0.659 0.657 0.730 0.825 0.754 0.754 0.728</code></pre>
<p>分析：两种模型的<span class="math inline">\(R^2\)</span>提取结果如上面代码所示。</p>
</div>
</div>
<div id="question-28" class="section level2">
<h2>Question</h2>
<p>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb166-2"><a href="#cb166-2" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb166-3"><a href="#cb166-3" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb166-4"><a href="#cb166-4" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb166-5"><a href="#cb166-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using [[
directly.</p>
</div>
<div id="answer-32" class="section level2">
<h2>Answer</h2>
<p>思路：调用sapply函数提取每一个trial的p值，省去了for循环，并且简化输出结果。</p>
<div id="use-sapply-and-an-anonymous-function" class="section level3">
<h3>Use sapply() and an anonymous function</h3>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb167-2"><a href="#cb167-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb167-3"><a href="#cb167-3" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb167-4"><a href="#cb167-4" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb167-5"><a href="#cb167-5" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb167-6"><a href="#cb167-6" tabindex="-1"></a>)</span>
<span id="cb167-7"><a href="#cb167-7" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(i) {i<span class="sc">$</span>p.value})</span>
<span id="cb167-8"><a href="#cb167-8" tabindex="-1"></a>out</span></code></pre></div>
<pre><code>##   [1] 0.178810 0.994262 0.064786 0.952716 0.306703 0.198225 0.272316 0.283723
##   [9] 0.415011 0.151957 0.072626 0.249014 0.773939 0.225693 0.840328 0.987492
##  [17] 0.316112 0.481741 0.457890 0.565872 0.990402 0.257905 0.538179 0.764365
##  [25] 0.845552 0.905726 0.086725 0.763640 0.088858 0.531422 0.731525 0.195574
##  [33] 0.598924 0.702134 0.147169 0.552598 0.117003 0.233189 0.127240 0.115792
##  [41] 0.317030 0.691674 0.450514 0.315344 0.073584 1.000000 0.011100 0.580715
##  [49] 0.591842 0.638287 0.283350 0.722557 0.408820 0.127118 0.000508 0.841418
##  [57] 0.624022 0.650657 0.632088 0.578419 0.052008 0.920025 0.646534 0.344836
##  [65] 0.751639 0.687324 0.134493 0.490445 0.711864 0.020395 0.342793 0.960824
##  [73] 0.111338 0.546907 0.773231 0.626304 0.298304 0.146219 0.133932 0.814393
##  [81] 0.096840 0.974930 0.808057 0.346709 0.308444 0.600936 0.984471 0.703070
##  [89] 0.678263 0.565803 0.895622 0.723438 0.431025 0.061331 0.043636 0.359298
##  [97] 0.372410 0.953012 0.503028 0.594358</code></pre>
</div>
<div id="use-sapply-without-an-anonymous-function" class="section level3">
<h3>Use sapply() without an anonymous function</h3>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb169-3"><a href="#cb169-3" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb169-4"><a href="#cb169-4" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb169-5"><a href="#cb169-5" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb169-6"><a href="#cb169-6" tabindex="-1"></a>)</span>
<span id="cb169-7"><a href="#cb169-7" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">&#39;[[&#39;</span>,<span class="dv">3</span>)</span>
<span id="cb169-8"><a href="#cb169-8" tabindex="-1"></a>out</span></code></pre></div>
<pre><code>##   [1] 0.178810 0.994262 0.064786 0.952716 0.306703 0.198225 0.272316 0.283723
##   [9] 0.415011 0.151957 0.072626 0.249014 0.773939 0.225693 0.840328 0.987492
##  [17] 0.316112 0.481741 0.457890 0.565872 0.990402 0.257905 0.538179 0.764365
##  [25] 0.845552 0.905726 0.086725 0.763640 0.088858 0.531422 0.731525 0.195574
##  [33] 0.598924 0.702134 0.147169 0.552598 0.117003 0.233189 0.127240 0.115792
##  [41] 0.317030 0.691674 0.450514 0.315344 0.073584 1.000000 0.011100 0.580715
##  [49] 0.591842 0.638287 0.283350 0.722557 0.408820 0.127118 0.000508 0.841418
##  [57] 0.624022 0.650657 0.632088 0.578419 0.052008 0.920025 0.646534 0.344836
##  [65] 0.751639 0.687324 0.134493 0.490445 0.711864 0.020395 0.342793 0.960824
##  [73] 0.111338 0.546907 0.773231 0.626304 0.298304 0.146219 0.133932 0.814393
##  [81] 0.096840 0.974930 0.808057 0.346709 0.308444 0.600936 0.984471 0.703070
##  [89] 0.678263 0.565803 0.895622 0.723438 0.431025 0.061331 0.043636 0.359298
##  [97] 0.372410 0.953012 0.503028 0.594358</code></pre>
<p>分析：输出结果为一个包含所有p值的向量，而不是一个列表，简化了输出结果。</p>
</div>
</div>
<div id="question-29" class="section level2">
<h2>Question</h2>
<p>Implement a combination of Map() and vapply() to create an lapply()
variant that iterates in parallel over all of its inputs and stores its
outputs in a vector (or a matrix). What arguments should the function
take?</p>
</div>
<div id="answer-33" class="section level2">
<h2>Answer</h2>
<p>思路：首先需要定义一个函数，它需要接受的参数有：要应用的函数f，一系列列表（函数中需要对列表长度进行比较，长度相同才能正常调用，否则输出提示信息），传递给vapply()的其他参数，例如USE.NAMES或FUN.VALUE。</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a>my_lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(f, df, fun_value) {</span>
<span id="cb171-2"><a href="#cb171-2" tabindex="-1"></a>  <span class="co"># 检查输入列表长度是否一致</span></span>
<span id="cb171-3"><a href="#cb171-3" tabindex="-1"></a>  list_lengths <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">list</span>(df), length)</span>
<span id="cb171-4"><a href="#cb171-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(list_lengths)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb171-5"><a href="#cb171-5" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;All input lists must have the same length.&quot;</span>)</span>
<span id="cb171-6"><a href="#cb171-6" tabindex="-1"></a>  }</span>
<span id="cb171-7"><a href="#cb171-7" tabindex="-1"></a>  </span>
<span id="cb171-8"><a href="#cb171-8" tabindex="-1"></a>  <span class="co"># 使用 Map() 并行应用函数f到所有输入</span></span>
<span id="cb171-9"><a href="#cb171-9" tabindex="-1"></a>  mapped_results <span class="ot">&lt;-</span> <span class="fu">Map</span>(f, df)</span>
<span id="cb171-10"><a href="#cb171-10" tabindex="-1"></a>  </span>
<span id="cb171-11"><a href="#cb171-11" tabindex="-1"></a>  <span class="co"># 使用 vapply() 将结果转换为向量或矩阵</span></span>
<span id="cb171-12"><a href="#cb171-12" tabindex="-1"></a>  final_results <span class="ot">&lt;-</span> <span class="fu">vapply</span>(mapped_results, <span class="cf">function</span>(x) x, <span class="at">FUN.VALUE=</span>fun_value)</span>
<span id="cb171-13"><a href="#cb171-13" tabindex="-1"></a>  <span class="fu">return</span>(final_results)</span>
<span id="cb171-14"><a href="#cb171-14" tabindex="-1"></a>}</span>
<span id="cb171-15"><a href="#cb171-15" tabindex="-1"></a></span>
<span id="cb171-16"><a href="#cb171-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb171-17"><a href="#cb171-17" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">replicate</span>(<span class="dv">6</span>,<span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="dv">10</span>,<span class="at">rep=</span>T)))</span>
<span id="cb171-18"><a href="#cb171-18" tabindex="-1"></a>fun_value <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">min=</span><span class="dv">0</span>,<span class="at">Qu1=</span><span class="dv">0</span>,<span class="at">median=</span><span class="dv">0</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">Qu3=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">0</span>)</span>
<span id="cb171-19"><a href="#cb171-19" tabindex="-1"></a><span class="fu">my_lapply</span>(summary, df, fun_value)</span></code></pre></div>
<pre><code>##          X1    X2    X3 X4   X5    X6
## min     2.0  1.00  2.00  1  1.0  3.00
## Qu1     6.0  3.25  4.00  3  3.0  7.00
## median  7.5  6.50  6.50  4  5.0  7.00
## mean    7.0  5.70  6.30  5  5.4  7.30
## Qu3     9.5  8.00  8.75  8  8.0  9.25
## max    10.0 10.00 10.00 10 10.0 10.00</code></pre>
<p>分析：上面的my_lapply结合了Map()和vapply()，实现了可以多个列表输入并将输出结果保存在一个矩阵中的功能。</p>
</div>
<div id="question-30" class="section level2">
<h2>Question</h2>
<p>Make a faster version of chisq.test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values. You can try simplifying chisq.test() or by coding from
the mathematical definition (<a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test" class="uri">http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test</a>).</p>
</div>
<div id="answer-34" class="section level2">
<h2>Answer</h2>
<p>思路：依据卡方检验的数学定义公式来编写我的卡方检验函数，由于输入数据为两个相同长度的数字型向量，所以不要考虑其他类型情况，输出为一个包含卡方值、自由度、p值的列表。p值可以借助pchisq函数算出。卡方值计算公式如下：
<span class="math display">\[x^2=\sum\frac{(A-T)^2}{T}\]</span>
其中，A为实际值，T为理论值。</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a>my_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb173-2"><a href="#cb173-2" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x, y)</span>
<span id="cb173-3"><a href="#cb173-3" tabindex="-1"></a>  <span class="co"># Calculate row totals</span></span>
<span id="cb173-4"><a href="#cb173-4" tabindex="-1"></a>  row_total <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rowSums</span>(m))</span>
<span id="cb173-5"><a href="#cb173-5" tabindex="-1"></a>  </span>
<span id="cb173-6"><a href="#cb173-6" tabindex="-1"></a>  <span class="co"># Calculate column totals</span></span>
<span id="cb173-7"><a href="#cb173-7" tabindex="-1"></a>  col_total <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">colSums</span>(m)))</span>
<span id="cb173-8"><a href="#cb173-8" tabindex="-1"></a>  </span>
<span id="cb173-9"><a href="#cb173-9" tabindex="-1"></a>  <span class="co"># Calculate grand total</span></span>
<span id="cb173-10"><a href="#cb173-10" tabindex="-1"></a>  grand_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(m)</span>
<span id="cb173-11"><a href="#cb173-11" tabindex="-1"></a>  </span>
<span id="cb173-12"><a href="#cb173-12" tabindex="-1"></a>  <span class="co"># Calculate expected frequencies</span></span>
<span id="cb173-13"><a href="#cb173-13" tabindex="-1"></a>  m_expected <span class="ot">&lt;-</span> (row_total <span class="sc">%*%</span> col_total) <span class="sc">/</span> grand_total</span>
<span id="cb173-14"><a href="#cb173-14" tabindex="-1"></a>  </span>
<span id="cb173-15"><a href="#cb173-15" tabindex="-1"></a>  <span class="co"># Calculate chi-square statistic</span></span>
<span id="cb173-16"><a href="#cb173-16" tabindex="-1"></a>  chi_square <span class="ot">&lt;-</span> <span class="fu">sum</span>((m <span class="sc">-</span> m_expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> m_expected)</span>
<span id="cb173-17"><a href="#cb173-17" tabindex="-1"></a>  df <span class="ot">&lt;-</span> (<span class="fu">length</span>(row_total) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">length</span>(col_total) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb173-18"><a href="#cb173-18" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(chi_square, <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb173-19"><a href="#cb173-19" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">chi_square =</span> chi_square, <span class="at">df =</span> df, <span class="at">p_value =</span> p))</span>
<span id="cb173-20"><a href="#cb173-20" tabindex="-1"></a>}</span>
<span id="cb173-21"><a href="#cb173-21" tabindex="-1"></a></span>
<span id="cb173-22"><a href="#cb173-22" tabindex="-1"></a></span>
<span id="cb173-23"><a href="#cb173-23" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb173-24"><a href="#cb173-24" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>)</span>
<span id="cb173-25"><a href="#cb173-25" tabindex="-1"></a><span class="fu">my_chisq_test</span>(x,y)</span></code></pre></div>
<pre><code>## $chi_square
## [1] 1.07
## 
## $df
## [1] 4
## 
## $p_value
## [1] 0.899</code></pre>
<p>分析：这个卡方检验函数只用于输入为两个相同长度的数字型向量，没有考虑其他情况，且只输出3个卡方检验统计量，所以函数体内代码较少，没有chisq.test()复杂，相对运行速度更快。</p>
</div>
<div id="question-31" class="section level2">
<h2>Question</h2>
<p>Can you make a faster version of table() for the case of an input of
two integer vectors with no missing values? Can you use it to speed up
your chi-square test?</p>
</div>
<div id="answer-35" class="section level2">
<h2>Answer</h2>
<p>思路：先将两个向量各自的重复项去掉，用来确定table的行列数，然后用matrix函数初始化table，再利用一个循环将向量里的元素一个个对应位置填入table中。</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a>my_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb175-2"><a href="#cb175-2" tabindex="-1"></a>  <span class="co"># Find the unique values in both vectors to determine the range for the table</span></span>
<span id="cb175-3"><a href="#cb175-3" tabindex="-1"></a>  unique1 <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb175-4"><a href="#cb175-4" tabindex="-1"></a>  unique2 <span class="ot">&lt;-</span> <span class="fu">unique</span>(y)</span>
<span id="cb175-5"><a href="#cb175-5" tabindex="-1"></a>  </span>
<span id="cb175-6"><a href="#cb175-6" tabindex="-1"></a>  <span class="co"># Initialize the table</span></span>
<span id="cb175-7"><a href="#cb175-7" tabindex="-1"></a>  <span class="co"># The table will have length(unique1) rows and length(unique2) columns</span></span>
<span id="cb175-8"><a href="#cb175-8" tabindex="-1"></a>  table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(unique1), <span class="at">ncol =</span> <span class="fu">length</span>(unique2),<span class="at">dimnames =</span> <span class="fu">list</span>(unique1, unique2))</span>
<span id="cb175-9"><a href="#cb175-9" tabindex="-1"></a>  </span>
<span id="cb175-10"><a href="#cb175-10" tabindex="-1"></a>  <span class="co"># Fill in the table with counts</span></span>
<span id="cb175-11"><a href="#cb175-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb175-12"><a href="#cb175-12" tabindex="-1"></a>    row_index <span class="ot">&lt;-</span> <span class="fu">match</span>(x[i], unique1)</span>
<span id="cb175-13"><a href="#cb175-13" tabindex="-1"></a>    col_index <span class="ot">&lt;-</span> <span class="fu">match</span>(y[i], unique2)</span>
<span id="cb175-14"><a href="#cb175-14" tabindex="-1"></a>    table[row_index, col_index] <span class="ot">&lt;-</span> table[row_index, col_index] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb175-15"><a href="#cb175-15" tabindex="-1"></a>  }</span>
<span id="cb175-16"><a href="#cb175-16" tabindex="-1"></a>  </span>
<span id="cb175-17"><a href="#cb175-17" tabindex="-1"></a>  <span class="fu">return</span>(table)</span>
<span id="cb175-18"><a href="#cb175-18" tabindex="-1"></a>}</span>
<span id="cb175-19"><a href="#cb175-19" tabindex="-1"></a></span>
<span id="cb175-20"><a href="#cb175-20" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb175-21"><a href="#cb175-21" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>,<span class="st">&#39;D&#39;</span>,<span class="st">&#39;D&#39;</span>)</span>
<span id="cb175-22"><a href="#cb175-22" tabindex="-1"></a><span class="fu">my_table</span>(x,y)</span></code></pre></div>
<pre><code>##   A B C D
## 1 1 0 0 0
## 2 0 1 0 0
## 3 0 0 1 0
## 4 0 0 0 2</code></pre>
<p>分析：此方法生成的table与原函数table()生成的一致，且可以用来加速上一题编写的卡方检验函数，只需将原本计算row
totals、column totals、grand
total的代码替换成下面的代码，其余不变即可：</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">my_table</span>(x, y)</span>
<span id="cb177-2"><a href="#cb177-2" tabindex="-1"></a>  </span>
<span id="cb177-3"><a href="#cb177-3" tabindex="-1"></a><span class="co"># Calculate row and column totals</span></span>
<span id="cb177-4"><a href="#cb177-4" tabindex="-1"></a>row_totals <span class="ot">&lt;-</span> <span class="fu">apply</span>(table, <span class="dv">1</span>, sum)</span>
<span id="cb177-5"><a href="#cb177-5" tabindex="-1"></a>col_totals <span class="ot">&lt;-</span> <span class="fu">apply</span>(table, <span class="dv">2</span>, sum)</span>
<span id="cb177-6"><a href="#cb177-6" tabindex="-1"></a>grand_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(table)</span></code></pre></div>
</div>
<div id="question-9.8-1" class="section level2">
<h2>Question 9.8</h2>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[f(x,y)\propto\dbinom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\quad
x=0,1,...,n,0\leq y\leq 1.\]</span> It can be shown (see e.g. [23]) that
for fixed a,b,n, the conditional distributions are Binomial<span class="math inline">\((n,y)\)</span> and Beta<span class="math inline">\((x+a,n−x+b)\)</span>. Use the Gibbs sampler to
generate a chain with target joint density <span class="math inline">\(f(x,y)\)</span>.<br />
* Write an Rcpp function for Exercise 9.8.<br />
* Compare the corresponding generated random numbers with those by the R
function you wrote using the function “qqplot”.<br />
* Campare the computation time of the two functions with the function
“microbenchmark”.<br />
* Comments your results.</p>
</div>
<div id="answer-36" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a><span class="do">## R function for Exercise 9.8</span></span>
<span id="cb178-2"><a href="#cb178-2" tabindex="-1"></a>Gibbs_chain_R <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n, N, burn, x0, y0){</span>
<span id="cb178-3"><a href="#cb178-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)   <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb178-4"><a href="#cb178-4" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(x0,y0)</span>
<span id="cb178-5"><a href="#cb178-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb178-6"><a href="#cb178-6" tabindex="-1"></a>    y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb178-7"><a href="#cb178-7" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb178-8"><a href="#cb178-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb178-9"><a href="#cb178-9" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb178-10"><a href="#cb178-10" tabindex="-1"></a>  }</span>
<span id="cb178-11"><a href="#cb178-11" tabindex="-1"></a>  b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb178-12"><a href="#cb178-12" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb178-13"><a href="#cb178-13" tabindex="-1"></a>  <span class="fu">return</span>(x1)</span>
<span id="cb178-14"><a href="#cb178-14" tabindex="-1"></a>}</span></code></pre></div>
<p>Rcpp function for Exercise 9.8</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a><span class="co">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb179-2"><a href="#cb179-2" tabindex="-1"></a>using namespace Rcpp;</span>
<span id="cb179-3"><a href="#cb179-3" tabindex="-1"></a></span>
<span id="cb179-4"><a href="#cb179-4" tabindex="-1"></a><span class="sc">/</span><span class="er">/</span> [[Rcpp<span class="sc">::</span>export]]</span>
<span id="cb179-5"><a href="#cb179-5" tabindex="-1"></a>NumericMatrix <span class="fu">Gibbs_chain_C</span>(double a, double b, int n, int N, int burn, int x0, double y0) {</span>
<span id="cb179-6"><a href="#cb179-6" tabindex="-1"></a>  NumericMatrix <span class="fu">X</span>(N, <span class="dv">2</span>);</span>
<span id="cb179-7"><a href="#cb179-7" tabindex="-1"></a>  <span class="fu">X</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="ot">=</span> x0;</span>
<span id="cb179-8"><a href="#cb179-8" tabindex="-1"></a>  <span class="fu">X</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="ot">=</span> y0;</span>
<span id="cb179-9"><a href="#cb179-9" tabindex="-1"></a>  int x;</span>
<span id="cb179-10"><a href="#cb179-10" tabindex="-1"></a>  double y;</span>
<span id="cb179-11"><a href="#cb179-11" tabindex="-1"></a>  <span class="cf">for</span>(int <span class="at">i =</span> <span class="dv">1</span>; i <span class="sc">&lt;</span> N; i<span class="sc">++</span>){</span>
<span id="cb179-12"><a href="#cb179-12" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">X</span>(i<span class="dv">-1</span>,<span class="dv">1</span>);</span>
<span id="cb179-13"><a href="#cb179-13" tabindex="-1"></a>    <span class="fu">X</span>(i,<span class="dv">0</span>) <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)[<span class="dv">0</span>];</span>
<span id="cb179-14"><a href="#cb179-14" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">X</span>(i,<span class="dv">0</span>);</span>
<span id="cb179-15"><a href="#cb179-15" tabindex="-1"></a>    <span class="fu">X</span>(i,<span class="dv">1</span>) <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)[<span class="dv">0</span>];</span>
<span id="cb179-16"><a href="#cb179-16" tabindex="-1"></a>  }</span>
<span id="cb179-17"><a href="#cb179-17" tabindex="-1"></a>  NumericMatrix <span class="fu">x1</span>(N<span class="sc">-</span>burn, <span class="dv">2</span>);</span>
<span id="cb179-18"><a href="#cb179-18" tabindex="-1"></a>  <span class="cf">for</span>(int <span class="at">i =</span> burn; i <span class="sc">&lt;</span> N; i<span class="sc">++</span>){</span>
<span id="cb179-19"><a href="#cb179-19" tabindex="-1"></a>    <span class="fu">x1</span>(i <span class="sc">-</span> burn,<span class="dv">0</span>) <span class="ot">=</span> <span class="fu">X</span>(i,<span class="dv">0</span>);</span>
<span id="cb179-20"><a href="#cb179-20" tabindex="-1"></a>    <span class="fu">x1</span>(i <span class="sc">-</span> burn,<span class="dv">1</span>) <span class="ot">=</span> <span class="fu">X</span>(i,<span class="dv">1</span>);</span>
<span id="cb179-21"><a href="#cb179-21" tabindex="-1"></a>  }</span>
<span id="cb179-22"><a href="#cb179-22" tabindex="-1"></a>  return x1;</span>
<span id="cb179-23"><a href="#cb179-23" tabindex="-1"></a>}</span></code></pre></div>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”.<br />
Campare the computation time of the two functions with the function
“microbenchmark”.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a>Gibbs_chain_R <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n, N, burn, x0, y0){</span>
<span id="cb180-2"><a href="#cb180-2" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)   <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb180-3"><a href="#cb180-3" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(x0,y0)</span>
<span id="cb180-4"><a href="#cb180-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb180-5"><a href="#cb180-5" tabindex="-1"></a>    y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb180-6"><a href="#cb180-6" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb180-7"><a href="#cb180-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb180-8"><a href="#cb180-8" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb180-9"><a href="#cb180-9" tabindex="-1"></a>  }</span>
<span id="cb180-10"><a href="#cb180-10" tabindex="-1"></a>  b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb180-11"><a href="#cb180-11" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb180-12"><a href="#cb180-12" tabindex="-1"></a>  <span class="fu">return</span>(x1)</span>
<span id="cb180-13"><a href="#cb180-13" tabindex="-1"></a>}</span>
<span id="cb180-14"><a href="#cb180-14" tabindex="-1"></a></span>
<span id="cb180-15"><a href="#cb180-15" tabindex="-1"></a><span class="fu">library</span>(SA24168406)</span>
<span id="cb180-16"><a href="#cb180-16" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb180-17"><a href="#cb180-17" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb182-2"><a href="#cb182-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e4</span>                <span class="co">#length of chain</span></span>
<span id="cb182-3"><a href="#cb182-3" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span>            <span class="co">#burn-in length</span></span>
<span id="cb182-4"><a href="#cb182-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb182-5"><a href="#cb182-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb182-6"><a href="#cb182-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb182-7"><a href="#cb182-7" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb182-8"><a href="#cb182-8" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb182-9"><a href="#cb182-9" tabindex="-1"></a></span>
<span id="cb182-10"><a href="#cb182-10" tabindex="-1"></a>xR <span class="ot">&lt;-</span> <span class="fu">Gibbs_chain_R</span>(a, b, n, N, burn, x0, y0)</span>
<span id="cb182-11"><a href="#cb182-11" tabindex="-1"></a>xC <span class="ot">&lt;-</span> <span class="fu">Gibbs_chain_C</span>(a, b, n, N, burn, x0, y0)</span>
<span id="cb182-12"><a href="#cb182-12" tabindex="-1"></a><span class="fu">qqplot</span>(xR, xC, <span class="at">main =</span> <span class="st">&quot;QQ Plot Comparison&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;R Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;C Quantiles&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbR=</span><span class="fu">Gibbs_chain_R</span>(a, b, n, N, burn, x0, y0),<span class="at">gibbC=</span><span class="fu">Gibbs_chain_C</span>(a, b, n, N, burn, x0, y0))</span>
<span id="cb183-2"><a href="#cb183-2" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##    expr    lq median    uq
## 1 gibbR 24.29  25.38 27.12
## 2 gibbC  5.46   5.59  5.67</code></pre>
<p>分析：通过Q-Q图可以直观地发现利用R函数和利用C++函数生成的随机数都来自同一分布，因为图上的点大致落在直线y
= x上，这表明这两个分布是相似的。<br />
通过计时函数可以明显发现使用c++语言编写的函数运行速度比R语言编写的函数快很多，差不多是R函数的1/8时间。因此，我认为c++语言的效率在大多数情况下要比R语言高，尤其是在有很多for循环的情况下，提升更加明显。</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
